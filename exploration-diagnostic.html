<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Exploration Diagnostic | Supplemental info about phylodiversity in evolutionary computation</title>
  <meta name="description" content="Supplemental info for ‘What can phylogenetic metrics tell us about useful diversity in evolutionary algorithms?’" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Exploration Diagnostic | Supplemental info about phylodiversity in evolutionary computation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Supplemental info for ‘What can phylogenetic metrics tell us about useful diversity in evolutionary algorithms?’" />
  <meta name="github-repo" content="emilydolson/phylodiversity-metrics-in-EC-GPTP-2021" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Exploration Diagnostic | Supplemental info about phylodiversity in evolutionary computation" />
  
  <meta name="twitter:description" content="Supplemental info for ‘What can phylogenetic metrics tell us about useful diversity in evolutionary algorithms?’" />
  

<meta name="author" content="Jose Guadalupe Hernandez, Alexander Lalejini, Emily Dolson" />


<meta name="date" content="2021-09-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="other-fitness-landscapes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Supplemental info</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-our-supplemental-material"><i class="fa fa-check"></i><b>1.1</b> About our supplemental material</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contributing-authors"><i class="fa fa-check"></i><b>1.2</b> Contributing authors</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#research-overview"><i class="fa fa-check"></i><b>1.3</b> Research overview</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#abstract"><i class="fa fa-check"></i><b>1.3.1</b> Abstract</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html"><i class="fa fa-check"></i><b>2</b> Exploration Diagnostic</a><ul>
<li class="chapter" data-level="2.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#setup"><i class="fa fa-check"></i><b>2.1</b> Setup</a></li>
<li class="chapter" data-level="2.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#performance"><i class="fa fa-check"></i><b>2.2</b> Performance</a><ul>
<li class="chapter" data-level="2.2.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#over-time"><i class="fa fa-check"></i><b>2.2.1</b> Over time</a><ul>
<li class="chapter" data-level="2.2.1.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#trait-performance"><i class="fa fa-check"></i><b>2.2.1.1</b> Trait performance</a></li>
<li class="chapter" data-level="2.2.1.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#activation-position-coverage"><i class="fa fa-check"></i><b>2.2.1.2</b> Activation position coverage</a></li>
</ul></li>
<li class="chapter" data-level="2.2.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#final"><i class="fa fa-check"></i><b>2.2.2</b> Final</a><ul>
<li class="chapter" data-level="2.2.2.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#trait-performance-1"><i class="fa fa-check"></i><b>2.2.2.1</b> Trait performance</a></li>
<li class="chapter" data-level="2.2.2.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#final-activation-position-coverage"><i class="fa fa-check"></i><b>2.2.2.2</b> Final activation position Coverage</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#phylogenetic-diversity"><i class="fa fa-check"></i><b>2.3</b> Phylogenetic diversity</a><ul>
<li class="chapter" data-level="2.3.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#over-time-1"><i class="fa fa-check"></i><b>2.3.1</b> Over time</a></li>
<li class="chapter" data-level="2.3.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#final-1"><i class="fa fa-check"></i><b>2.3.2</b> Final</a><ul>
<li class="chapter" data-level="2.3.2.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-pairwise-distance"><i class="fa fa-check"></i><b>2.3.2.1</b> Mean pairwise distance</a></li>
<li class="chapter" data-level="2.3.2.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-evolutionary-distinctiveness"><i class="fa fa-check"></i><b>2.3.2.2</b> Mean evolutionary distinctiveness</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#phenotypic-diversity"><i class="fa fa-check"></i><b>2.4</b> Phenotypic diversity</a><ul>
<li class="chapter" data-level="2.4.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#relationship-between-different-types-of-phenotypic-diversity"><i class="fa fa-check"></i><b>2.4.1</b> Relationship between different types of phenotypic diversity</a></li>
<li class="chapter" data-level="2.4.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#over-time-2"><i class="fa fa-check"></i><b>2.4.2</b> Over time</a></li>
<li class="chapter" data-level="2.4.3" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#final-2"><i class="fa fa-check"></i><b>2.4.3</b> Final</a><ul>
<li class="chapter" data-level="2.4.3.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#richness"><i class="fa fa-check"></i><b>2.4.3.1</b> Richness</a></li>
<li class="chapter" data-level="2.4.3.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#shannon-diversity"><i class="fa fa-check"></i><b>2.4.3.2</b> Shannon diversity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#relationship-between-phenotypic-and-phylogenetic-diversity"><i class="fa fa-check"></i><b>2.5</b> Relationship between phenotypic and phylogenetic diversity</a></li>
<li class="chapter" data-level="2.6" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#relationship-between-diversity-and-success"><i class="fa fa-check"></i><b>2.6</b> Relationship between diversity and success</a><ul>
<li class="chapter" data-level="2.6.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#earlier-in-run"><i class="fa fa-check"></i><b>2.6.1</b> Earlier in run</a></li>
<li class="chapter" data-level="2.6.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#end-of-run"><i class="fa fa-check"></i><b>2.6.2</b> End of run</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#causality-analysis"><i class="fa fa-check"></i><b>2.7</b> Causality analysis</a><ul>
<li class="chapter" data-level="2.7.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#transfer-entropy-from-diversity-to-fitness"><i class="fa fa-check"></i><b>2.7.1</b> Transfer entropy from diversity to fitness</a><ul>
<li class="chapter" data-level="2.7.1.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#max-pairwise-distance-vs.-phenotypic-richness"><i class="fa fa-check"></i><b>2.7.1.1</b> Max pairwise distance vs. phenotypic richness</a></li>
<li class="chapter" data-level="2.7.1.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-pairwise-distance-vs.-phenotypic-richness"><i class="fa fa-check"></i><b>2.7.1.2</b> Mean pairwise distance vs. phenotypic richness</a></li>
<li class="chapter" data-level="2.7.1.3" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-pairwise-distance-vs.-shannon-entropy"><i class="fa fa-check"></i><b>2.7.1.3</b> Mean pairwise distance vs. shannon entropy</a></li>
<li class="chapter" data-level="2.7.1.4" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-evolutionary-distinctiveness-vs.-phenotypic-richness"><i class="fa fa-check"></i><b>2.7.1.4</b> Mean evolutionary distinctiveness vs. phenotypic richness</a></li>
<li class="chapter" data-level="2.7.1.5" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-evolutionary-distinctiveness-vs.-shannon-entropy"><i class="fa fa-check"></i><b>2.7.1.5</b> Mean evolutionary distinctiveness vs. shannon entropy</a></li>
</ul></li>
<li class="chapter" data-level="2.7.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#transfer-entropy-between-types-of-diversity"><i class="fa fa-check"></i><b>2.7.2</b> Transfer entropy between types of diversity</a><ul>
<li class="chapter" data-level="2.7.2.1" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#max-pairwise-distance-and-phenotypic-richness"><i class="fa fa-check"></i><b>2.7.2.1</b> Max pairwise distance and phenotypic richness</a></li>
<li class="chapter" data-level="2.7.2.2" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-pairwise-distance-and-phenotypic-richness"><i class="fa fa-check"></i><b>2.7.2.2</b> Mean pairwise distance and phenotypic richness</a></li>
<li class="chapter" data-level="2.7.2.3" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-pairwise-distance-and-shannon-diversity"><i class="fa fa-check"></i><b>2.7.2.3</b> Mean pairwise distance and shannon diversity</a></li>
<li class="chapter" data-level="2.7.2.4" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-evolutionary-distinctiveness-and-phenotypic-richness"><i class="fa fa-check"></i><b>2.7.2.4</b> Mean evolutionary distinctiveness and phenotypic richness</a></li>
<li class="chapter" data-level="2.7.2.5" data-path="exploration-diagnostic.html"><a href="exploration-diagnostic.html#mean-evolutionary-distinctiveness-and-shannon-diversity"><i class="fa fa-check"></i><b>2.7.2.5</b> Mean evolutionary distinctiveness and shannon diversity</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html"><i class="fa fa-check"></i><b>3</b> Other fitness landscapes</a><ul>
<li class="chapter" data-level="3.1" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#setup-1"><i class="fa fa-check"></i><b>3.1</b> Setup</a></li>
<li class="chapter" data-level="3.2" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#performance-1"><i class="fa fa-check"></i><b>3.2</b> Performance</a><ul>
<li class="chapter" data-level="3.2.1" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#over-time-3"><i class="fa fa-check"></i><b>3.2.1</b> Over time</a></li>
<li class="chapter" data-level="3.2.2" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#final-3"><i class="fa fa-check"></i><b>3.2.2</b> Final</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#phylogenetic-diversity-1"><i class="fa fa-check"></i><b>3.3</b> Phylogenetic diversity</a><ul>
<li class="chapter" data-level="3.3.1" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#over-time-4"><i class="fa fa-check"></i><b>3.3.1</b> Over time</a></li>
<li class="chapter" data-level="3.3.2" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#final-4"><i class="fa fa-check"></i><b>3.3.2</b> Final</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#phenotypic-diversity-1"><i class="fa fa-check"></i><b>3.4</b> Phenotypic diversity</a><ul>
<li class="chapter" data-level="3.4.1" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#over-time-5"><i class="fa fa-check"></i><b>3.4.1</b> Over time</a></li>
<li class="chapter" data-level="3.4.2" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#final-5"><i class="fa fa-check"></i><b>3.4.2</b> Final</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#relationship-between-phenotypic-and-phylogenetic-diversity-1"><i class="fa fa-check"></i><b>3.5</b> Relationship between phenotypic and phylogenetic diversity</a></li>
<li class="chapter" data-level="3.6" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#relationship-between-diversity-and-success-1"><i class="fa fa-check"></i><b>3.6</b> Relationship between diversity and success</a><ul>
<li class="chapter" data-level="3.6.1" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#earlier-in-run-1"><i class="fa fa-check"></i><b>3.6.1</b> Earlier in run</a></li>
<li class="chapter" data-level="3.6.2" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#end-of-run-1"><i class="fa fa-check"></i><b>3.6.2</b> End of run</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="other-fitness-landscapes.html"><a href="other-fitness-landscapes.html#causality-analysis-1"><i class="fa fa-check"></i><b>3.7</b> Causality analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with ❤ and bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supplemental info about phylodiversity in evolutionary computation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploration-diagnostic" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Exploration Diagnostic</h1>
<div id="setup" class="section level2">
<h2><span class="header-section-number">2.1</span> Setup</h2>
<p>Include dependencies</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="exploration-diagnostic.html#cb1-1"></a><span class="kw">library</span>(ggplot2)       <span class="co"># For plotting</span></span>
<span id="cb1-2"><a href="exploration-diagnostic.html#cb1-2"></a><span class="kw">library</span>(tidyverse)     <span class="co"># For data wrangling</span></span>
<span id="cb1-3"><a href="exploration-diagnostic.html#cb1-3"></a><span class="kw">library</span>(knitr)         <span class="co"># For making nice rmarkdown documents</span></span>
<span id="cb1-4"><a href="exploration-diagnostic.html#cb1-4"></a><span class="kw">library</span>(cowplot)       <span class="co"># For theme</span></span>
<span id="cb1-5"><a href="exploration-diagnostic.html#cb1-5"></a><span class="kw">library</span>(viridis)       <span class="co"># For color scale</span></span>
<span id="cb1-6"><a href="exploration-diagnostic.html#cb1-6"></a><span class="kw">library</span>(RColorBrewer)  <span class="co"># For more color scales</span></span>
<span id="cb1-7"><a href="exploration-diagnostic.html#cb1-7"></a><span class="kw">library</span>(rstatix)</span>
<span id="cb1-8"><a href="exploration-diagnostic.html#cb1-8"></a><span class="kw">library</span>(ggsignif)      <span class="co"># For adding pairwise significance to plots</span></span>
<span id="cb1-9"><a href="exploration-diagnostic.html#cb1-9"></a><span class="kw">library</span>(Hmisc)         <span class="co"># For bootstrapping condifence internvals</span></span>
<span id="cb1-10"><a href="exploration-diagnostic.html#cb1-10"></a><span class="kw">library</span>(kableExtra)    <span class="co"># For displaying nice tables</span></span>
<span id="cb1-11"><a href="exploration-diagnostic.html#cb1-11"></a><span class="kw">source</span>(<span class="st">&quot;https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R&quot;</span>) <span class="co"># For raincloud plots</span></span>
<span id="cb1-12"><a href="exploration-diagnostic.html#cb1-12"></a><span class="kw">library</span>(readr)        <span class="co"># For reading in data</span></span>
<span id="cb1-13"><a href="exploration-diagnostic.html#cb1-13"></a><span class="kw">library</span>(stringr)      <span class="co"># For manipulating string data</span></span>
<span id="cb1-14"><a href="exploration-diagnostic.html#cb1-14"></a><span class="kw">library</span>(ggpubr)       <span class="co"># For displaying correlation statistics on plots</span></span>
<span id="cb1-15"><a href="exploration-diagnostic.html#cb1-15"></a><span class="kw">library</span>(infotheo)     <span class="co"># For causality analysis</span></span>
<span id="cb1-16"><a href="exploration-diagnostic.html#cb1-16"></a><span class="kw">library</span>(scales)       <span class="co"># For displaying scales nicely in facetted plots</span></span>
<span id="cb1-17"><a href="exploration-diagnostic.html#cb1-17"></a><span class="kw">library</span>(osfr)         <span class="co"># For downloading the data for this project</span></span></code></pre></div>
<p>These analyses were conducted in the following computing environment:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="exploration-diagnostic.html#cb2-1"></a><span class="kw">print</span>(version)</span></code></pre></div>
<pre><code>##                _                           
## platform       x86_64-apple-darwin17.0     
## arch           x86_64                      
## os             darwin17.0                  
## system         x86_64, darwin17.0          
## status                                     
## major          4                           
## minor          1.1                         
## year           2021                        
## month          08                          
## day            10                          
## svn rev        80725                       
## language       R                           
## version.string R version 4.1.1 (2021-08-10)
## nickname       Kick Things</code></pre>
<p>Setup constants to be used across plots</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="exploration-diagnostic.html#cb4-1"></a><span class="co"># Labeler for stats annotations</span></span>
<span id="cb4-2"><a href="exploration-diagnostic.html#cb4-2"></a>p_label &lt;-<span class="st"> </span><span class="cf">function</span>(p_value) {</span>
<span id="cb4-3"><a href="exploration-diagnostic.html#cb4-3"></a>  threshold =<span class="st"> </span><span class="fl">0.0001</span></span>
<span id="cb4-4"><a href="exploration-diagnostic.html#cb4-4"></a>  <span class="cf">if</span> (p_value <span class="op">&lt;</span><span class="st"> </span>threshold) {</span>
<span id="cb4-5"><a href="exploration-diagnostic.html#cb4-5"></a>    <span class="kw">return</span>(<span class="kw">paste0</span>(<span class="st">&quot;p &lt; &quot;</span>, threshold))</span>
<span id="cb4-6"><a href="exploration-diagnostic.html#cb4-6"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-7"><a href="exploration-diagnostic.html#cb4-7"></a>    <span class="kw">return</span>(<span class="kw">paste0</span>(<span class="st">&quot;p = &quot;</span>, p_value))</span>
<span id="cb4-8"><a href="exploration-diagnostic.html#cb4-8"></a>  }</span>
<span id="cb4-9"><a href="exploration-diagnostic.html#cb4-9"></a>}</span>
<span id="cb4-10"><a href="exploration-diagnostic.html#cb4-10"></a></span>
<span id="cb4-11"><a href="exploration-diagnostic.html#cb4-11"></a><span class="co"># Significance threshold</span></span>
<span id="cb4-12"><a href="exploration-diagnostic.html#cb4-12"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb4-13"><a href="exploration-diagnostic.html#cb4-13"></a></span>
<span id="cb4-14"><a href="exploration-diagnostic.html#cb4-14"></a><span class="co"># Common graph variables</span></span>
<span id="cb4-15"><a href="exploration-diagnostic.html#cb4-15"></a>performance_ylim &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-16"><a href="exploration-diagnostic.html#cb4-16"></a>coverage_ylim &lt;-<span class="st"> </span><span class="fl">1.0</span></span>
<span id="cb4-17"><a href="exploration-diagnostic.html#cb4-17"></a></span>
<span id="cb4-18"><a href="exploration-diagnostic.html#cb4-18"></a><span class="co">####### misc #######</span></span>
<span id="cb4-19"><a href="exploration-diagnostic.html#cb4-19"></a><span class="co"># Configure our default graphing theme</span></span>
<span id="cb4-20"><a href="exploration-diagnostic.html#cb4-20"></a><span class="kw">theme_set</span>(<span class="kw">theme_cowplot</span>())</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="exploration-diagnostic.html#cb5-1"></a><span class="co"># Read in data</span></span>
<span id="cb5-2"><a href="exploration-diagnostic.html#cb5-2"></a><span class="kw">osf_retrieve_file</span>(<span class="st">&quot;esm4r&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">osf_download</span>(<span class="dt">conflicts =</span> <span class="st">&quot;skip&quot;</span>)  <span class="co"># Download data from osf</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   name                                  id          local_path          meta    
##   &lt;chr&gt;                                 &lt;chr&gt;       &lt;chr&gt;               &lt;list&gt;  
## 1 final_exploration_diagnostic_data.csv 612fe97aab… ./final_exploratio… &lt;named …</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="exploration-diagnostic.html#cb7-1"></a>data_loc &lt;-<span class="st"> &quot;final_exploration_diagnostic_data.csv&quot;</span></span>
<span id="cb7-2"><a href="exploration-diagnostic.html#cb7-2"></a></span>
<span id="cb7-3"><a href="exploration-diagnostic.html#cb7-3"></a>data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(data_loc, <span class="dt">na=</span><span class="kw">c</span>(<span class="st">&quot;NONE&quot;</span>, <span class="st">&quot;NA&quot;</span>, <span class="st">&quot;&quot;</span>))</span>
<span id="cb7-4"><a href="exploration-diagnostic.html#cb7-4"></a></span>
<span id="cb7-5"><a href="exploration-diagnostic.html#cb7-5"></a><span class="co">## Clean up data columns</span></span>
<span id="cb7-6"><a href="exploration-diagnostic.html#cb7-6"></a></span>
<span id="cb7-7"><a href="exploration-diagnostic.html#cb7-7"></a><span class="co"># Make selection name column human readable</span></span>
<span id="cb7-8"><a href="exploration-diagnostic.html#cb7-8"></a>data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">selection_name =</span> <span class="kw">as.factor</span>(<span class="kw">case_when</span>(</span>
<span id="cb7-9"><a href="exploration-diagnostic.html#cb7-9"></a>  selection_name <span class="op">==</span><span class="st"> &quot;EpsilonLexicase&quot;</span> <span class="op">~</span><span class="st"> &quot;Lexicase&quot;</span>,</span>
<span id="cb7-10"><a href="exploration-diagnostic.html#cb7-10"></a>  TOUR_SIZE <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Random&quot;</span>,</span>
<span id="cb7-11"><a href="exploration-diagnostic.html#cb7-11"></a>  selection_name <span class="op">==</span><span class="st"> &quot;Tournament&quot;</span> <span class="op">~</span><span class="st"> &quot;Tournament&quot;</span>,</span>
<span id="cb7-12"><a href="exploration-diagnostic.html#cb7-12"></a>  selection_name <span class="op">==</span><span class="st"> &quot;FitnessSharing&quot;</span> <span class="op">~</span><span class="st"> &quot;Fitness Sharing&quot;</span>,</span>
<span id="cb7-13"><a href="exploration-diagnostic.html#cb7-13"></a>  selection_name <span class="op">==</span><span class="st"> &quot;EcoEa&quot;</span> <span class="op">~</span><span class="st"> &quot;EcoEA&quot;</span></span>
<span id="cb7-14"><a href="exploration-diagnostic.html#cb7-14"></a>)))</span>
<span id="cb7-15"><a href="exploration-diagnostic.html#cb7-15"></a></span>
<span id="cb7-16"><a href="exploration-diagnostic.html#cb7-16"></a><span class="co"># Calculate performance statistics.</span></span>
<span id="cb7-17"><a href="exploration-diagnostic.html#cb7-17"></a><span class="co"># Elite trait avg is the avg per-site performance of the best individual</span></span>
<span id="cb7-18"><a href="exploration-diagnostic.html#cb7-18"></a>data<span class="op">$</span>elite_trait_avg &lt;-</span>
<span id="cb7-19"><a href="exploration-diagnostic.html#cb7-19"></a><span class="st">  </span>data<span class="op">$</span>ele_agg_per <span class="op">/</span><span class="st"> </span>data<span class="op">$</span>OBJECTIVE_CNT</span>
<span id="cb7-20"><a href="exploration-diagnostic.html#cb7-20"></a>data<span class="op">$</span>unique_start_positions_coverage &lt;-</span>
<span id="cb7-21"><a href="exploration-diagnostic.html#cb7-21"></a><span class="st">  </span>data<span class="op">$</span>uni_str_pos <span class="op">/</span><span class="st"> </span>data<span class="op">$</span>OBJECTIVE_CNT</span>
<span id="cb7-22"><a href="exploration-diagnostic.html#cb7-22"></a></span>
<span id="cb7-23"><a href="exploration-diagnostic.html#cb7-23"></a><span class="co"># Convert elite_trait_avg to percent of maximum possible</span></span>
<span id="cb7-24"><a href="exploration-diagnostic.html#cb7-24"></a>data<span class="op">$</span>elite_trait_avg &lt;-<span class="st"> </span>data<span class="op">$</span>elite_trait_avg<span class="op">/</span>data<span class="op">$</span>TARGET</span>
<span id="cb7-25"><a href="exploration-diagnostic.html#cb7-25"></a></span>
<span id="cb7-26"><a href="exploration-diagnostic.html#cb7-26"></a><span class="co"># Grab data from just the final time point</span></span>
<span id="cb7-27"><a href="exploration-diagnostic.html#cb7-27"></a>final_data &lt;-<span class="st"> </span><span class="kw">filter</span>(data, evaluations<span class="op">==</span><span class="kw">max</span>(data<span class="op">$</span>evaluations))</span></code></pre></div>
</div>
<div id="performance" class="section level2">
<h2><span class="header-section-number">2.2</span> Performance</h2>
<p>For context, it’s important to know how each selection scheme performed on the exploration diagnostic.</p>
<div id="over-time" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Over time</h3>
<p>First we look at the dynamics of performance over time.</p>
<div id="trait-performance" class="section level4">
<h4><span class="header-section-number">2.2.1.1</span> Trait performance</h4>
<p>Plot average trait performance (i.e. fitness) over time for each selection scheme. We log the x-axis because Eco-EA gains fitness over a very long time scale, whereas the interesting dynamics for the other selection schemes occur relatively quickly.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="exploration-diagnostic.html#cb8-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb8-2"><a href="exploration-diagnostic.html#cb8-2"></a>    data,</span>
<span id="cb8-3"><a href="exploration-diagnostic.html#cb8-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb8-4"><a href="exploration-diagnostic.html#cb8-4"></a>      <span class="dt">x=</span>gen,                 <span class="co"># Generations</span></span>
<span id="cb8-5"><a href="exploration-diagnostic.html#cb8-5"></a>      <span class="dt">y=</span>elite_trait_avg,     <span class="co"># Performance</span></span>
<span id="cb8-6"><a href="exploration-diagnostic.html#cb8-6"></a>      <span class="dt">color=</span>selection_name,  <span class="co"># Selection scheme</span></span>
<span id="cb8-7"><a href="exploration-diagnostic.html#cb8-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb8-8"><a href="exploration-diagnostic.html#cb8-8"></a>    )</span>
<span id="cb8-9"><a href="exploration-diagnostic.html#cb8-9"></a>  ) <span class="op">+</span></span>
<span id="cb8-10"><a href="exploration-diagnostic.html#cb8-10"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun=</span>mean) <span class="op">+</span><span class="st"> </span><span class="co"># Plot line showing mean for each selection scheme</span></span>
<span id="cb8-11"><a href="exploration-diagnostic.html#cb8-11"></a><span class="st">  </span><span class="kw">stat_summary</span>(  <span class="co"># Add shading around each line indicating 95% confiedence interval</span></span>
<span id="cb8-12"><a href="exploration-diagnostic.html#cb8-12"></a>    <span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>,</span>
<span id="cb8-13"><a href="exploration-diagnostic.html#cb8-13"></a>    <span class="dt">fun.data=</span><span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb8-14"><a href="exploration-diagnostic.html#cb8-14"></a>    <span class="dt">fun.args=</span><span class="kw">list</span>(<span class="dt">conf.int=</span><span class="fl">0.95</span>),</span>
<span id="cb8-15"><a href="exploration-diagnostic.html#cb8-15"></a>    <span class="dt">alpha=</span><span class="fl">0.2</span>,</span>
<span id="cb8-16"><a href="exploration-diagnostic.html#cb8-16"></a>    <span class="dt">linetype=</span><span class="dv">0</span></span>
<span id="cb8-17"><a href="exploration-diagnostic.html#cb8-17"></a>  ) <span class="op">+</span></span>
<span id="cb8-18"><a href="exploration-diagnostic.html#cb8-18"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb8-19"><a href="exploration-diagnostic.html#cb8-19"></a>    <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span>, <span class="co"># Set y axis title</span></span>
<span id="cb8-20"><a href="exploration-diagnostic.html#cb8-20"></a>    <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, performance_ylim)  <span class="co"># Set y axis range to include all possible performance values</span></span>
<span id="cb8-21"><a href="exploration-diagnostic.html#cb8-21"></a>  ) <span class="op">+</span></span>
<span id="cb8-22"><a href="exploration-diagnostic.html#cb8-22"></a><span class="st">  </span><span class="kw">scale_x_log10</span>(  <span class="co"># Log x axis</span></span>
<span id="cb8-23"><a href="exploration-diagnostic.html#cb8-23"></a>    <span class="dt">name=</span><span class="st">&quot;Generation&quot;</span> <span class="co"># Set x axis title</span></span>
<span id="cb8-24"><a href="exploration-diagnostic.html#cb8-24"></a>  ) <span class="op">+</span></span>
<span id="cb8-25"><a href="exploration-diagnostic.html#cb8-25"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;Selection&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Set legend title</span></span>
<span id="cb8-26"><a href="exploration-diagnostic.html#cb8-26"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="st">&quot;Selection&quot;</span>)    <span class="co"># Set legend title</span></span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/performance_over_time-1.png" width="672" /></p>
<p>As observed by Hernandez et al. in their original paper on the exploration diagnostic, fitness in tournament selection initially increases quickly and then plateaus. Fitness in lexicase selection increases slightly slower but plateaus at a much higher value (nearly 100%). Fitness sharing behaves similarly to tournament selection, but maintains a slight upward trajectory (note that, because the x axis is on a log scale, this trajectory is very gradual). Eco-EA takes substantially longer to increase in fitness but ultimately surpasses fitness sharing and tournament selection. It is unclear whether it would pass lexicase selection if these runs were allowed to continue for slightly longer; they do not appear to have plateaued yet. We chose to cut them off at 500,000 generations due to resource constraints and the fact that the questions we’re asking here are not really about final fitness.</p>
</div>
<div id="activation-position-coverage" class="section level4">
<h4><span class="header-section-number">2.2.1.2</span> Activation position coverage</h4>
<p>Out of curiosity, we also ran the analysis of unique activation positions present in the population, used by Hernandez et. al. This analysis tells us about the diversity of start positions for the coding region represented in the population. As the set of start positions in the population tends to represent a meaningful constraint on the number of paths through the fitness landscape that are currently accessible, this is in some sense a metric of useful diversity in the population</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="exploration-diagnostic.html#cb9-1"></a><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>unique_start_positions_coverage, <span class="dt">color=</span>selection_name, <span class="dt">fill=</span>selection_name)) <span class="op">+</span></span>
<span id="cb9-2"><a href="exploration-diagnostic.html#cb9-2"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun=</span>mean) <span class="op">+</span></span>
<span id="cb9-3"><a href="exploration-diagnostic.html#cb9-3"></a><span class="st">  </span><span class="kw">stat_summary</span>(</span>
<span id="cb9-4"><a href="exploration-diagnostic.html#cb9-4"></a>    <span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>,</span>
<span id="cb9-5"><a href="exploration-diagnostic.html#cb9-5"></a>    <span class="dt">fun.data=</span><span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb9-6"><a href="exploration-diagnostic.html#cb9-6"></a>    <span class="dt">fun.args=</span><span class="kw">list</span>(<span class="dt">conf.int=</span><span class="fl">0.95</span>),</span>
<span id="cb9-7"><a href="exploration-diagnostic.html#cb9-7"></a>    <span class="dt">alpha=</span><span class="fl">0.2</span>,</span>
<span id="cb9-8"><a href="exploration-diagnostic.html#cb9-8"></a>    <span class="dt">linetype=</span><span class="dv">0</span></span>
<span id="cb9-9"><a href="exploration-diagnostic.html#cb9-9"></a>  ) <span class="op">+</span></span>
<span id="cb9-10"><a href="exploration-diagnostic.html#cb9-10"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb9-11"><a href="exploration-diagnostic.html#cb9-11"></a>    <span class="dt">name=</span><span class="st">&quot;Activation position coverage&quot;</span>,</span>
<span id="cb9-12"><a href="exploration-diagnostic.html#cb9-12"></a>    <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb9-13"><a href="exploration-diagnostic.html#cb9-13"></a>  ) <span class="op">+</span></span>
<span id="cb9-14"><a href="exploration-diagnostic.html#cb9-14"></a><span class="st">  </span><span class="kw">scale_x_log10</span>(</span>
<span id="cb9-15"><a href="exploration-diagnostic.html#cb9-15"></a>    <span class="dt">name=</span><span class="st">&quot;Generation&quot;</span></span>
<span id="cb9-16"><a href="exploration-diagnostic.html#cb9-16"></a>  ) <span class="op">+</span></span>
<span id="cb9-17"><a href="exploration-diagnostic.html#cb9-17"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;Selection&quot;</span>)<span class="op">+</span></span>
<span id="cb9-18"><a href="exploration-diagnostic.html#cb9-18"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="st">&quot;Selection&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/unique_start_positions-1.png" width="672" /></p>
<p>We see that lexicase selection maintains by far that largest number of unique start positions, even surpassing the number maintained by random drift. This suggests that lexicase selection is actively selecting for maintaining a diversity of start positions. Tournament selection and fitness sharing perform virtually identically, with Eco-EA falling in between.</p>
</div>
</div>
<div id="final" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Final</h3>
<p>While trends over time are more informative, it can be hard to visualize the full distribution (particularly the extent of variation). Thus, we also conduct a more detailed analysis of performance at the final time point.</p>
<div id="trait-performance-1" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> Trait performance</h4>
<p>First we conduct statistics to identify which selection schemes are significantly different from each other.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="exploration-diagnostic.html#cb10-1"></a><span class="co"># Compute manual labels for geom_signif</span></span>
<span id="cb10-2"><a href="exploration-diagnostic.html#cb10-2"></a>stat.test &lt;-<span class="st"> </span>final_data <span class="op">%&gt;%</span></span>
<span id="cb10-3"><a href="exploration-diagnostic.html#cb10-3"></a><span class="st">  </span><span class="kw">wilcox_test</span>(elite_trait_avg <span class="op">~</span><span class="st"> </span>selection_name) <span class="op">%&gt;%</span></span>
<span id="cb10-4"><a href="exploration-diagnostic.html#cb10-4"></a><span class="st">  </span><span class="kw">adjust_pvalue</span>(<span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Apply Bonferroni correction for multiple comparisons</span></span>
<span id="cb10-5"><a href="exploration-diagnostic.html#cb10-5"></a><span class="st">  </span><span class="kw">add_significance</span>() <span class="op">%&gt;%</span></span>
<span id="cb10-6"><a href="exploration-diagnostic.html#cb10-6"></a><span class="st">  </span><span class="kw">add_xy_position</span>(<span class="dt">x=</span><span class="st">&quot;selection_name&quot;</span>,<span class="dt">step.increase=</span><span class="dv">1</span>)</span>
<span id="cb10-7"><a href="exploration-diagnostic.html#cb10-7"></a>stat.test<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">mapply</span>(p_label,stat.test<span class="op">$</span>p.adj)</span></code></pre></div>
<p>Then we make raincloud plots of each selection scheme.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exploration-diagnostic.html#cb11-1"></a>elite_final_performance_fig &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb11-2"><a href="exploration-diagnostic.html#cb11-2"></a>    final_data,</span>
<span id="cb11-3"><a href="exploration-diagnostic.html#cb11-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb11-4"><a href="exploration-diagnostic.html#cb11-4"></a>      <span class="dt">x=</span>selection_name,</span>
<span id="cb11-5"><a href="exploration-diagnostic.html#cb11-5"></a>      <span class="dt">y=</span>elite_trait_avg,</span>
<span id="cb11-6"><a href="exploration-diagnostic.html#cb11-6"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb11-7"><a href="exploration-diagnostic.html#cb11-7"></a>    )</span>
<span id="cb11-8"><a href="exploration-diagnostic.html#cb11-8"></a>  ) <span class="op">+</span></span>
<span id="cb11-9"><a href="exploration-diagnostic.html#cb11-9"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(</span>
<span id="cb11-10"><a href="exploration-diagnostic.html#cb11-10"></a>    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>),</span>
<span id="cb11-11"><a href="exploration-diagnostic.html#cb11-11"></a>    <span class="dt">alpha =</span> <span class="fl">.8</span>,</span>
<span id="cb11-12"><a href="exploration-diagnostic.html#cb11-12"></a>    <span class="dt">scale=</span><span class="st">&quot;width&quot;</span></span>
<span id="cb11-13"><a href="exploration-diagnostic.html#cb11-13"></a>  ) <span class="op">+</span></span>
<span id="cb11-14"><a href="exploration-diagnostic.html#cb11-14"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb11-15"><a href="exploration-diagnostic.html#cb11-15"></a>    <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>selection_name),</span>
<span id="cb11-16"><a href="exploration-diagnostic.html#cb11-16"></a>    <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.15</span>),</span>
<span id="cb11-17"><a href="exploration-diagnostic.html#cb11-17"></a>    <span class="dt">size =</span> <span class="fl">.5</span>,</span>
<span id="cb11-18"><a href="exploration-diagnostic.html#cb11-18"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb11-19"><a href="exploration-diagnostic.html#cb11-19"></a>  ) <span class="op">+</span></span>
<span id="cb11-20"><a href="exploration-diagnostic.html#cb11-20"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(</span>
<span id="cb11-21"><a href="exploration-diagnostic.html#cb11-21"></a>    <span class="dt">width =</span> <span class="fl">.1</span>,</span>
<span id="cb11-22"><a href="exploration-diagnostic.html#cb11-22"></a>    <span class="dt">outlier.shape =</span> <span class="ot">NA</span>,</span>
<span id="cb11-23"><a href="exploration-diagnostic.html#cb11-23"></a>    <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb11-24"><a href="exploration-diagnostic.html#cb11-24"></a>  ) <span class="op">+</span></span>
<span id="cb11-25"><a href="exploration-diagnostic.html#cb11-25"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb11-26"><a href="exploration-diagnostic.html#cb11-26"></a>    <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span>,</span>
<span id="cb11-27"><a href="exploration-diagnostic.html#cb11-27"></a>    <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, performance_ylim)</span>
<span id="cb11-28"><a href="exploration-diagnostic.html#cb11-28"></a>  ) <span class="op">+</span></span>
<span id="cb11-29"><a href="exploration-diagnostic.html#cb11-29"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(</span>
<span id="cb11-30"><a href="exploration-diagnostic.html#cb11-30"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb11-31"><a href="exploration-diagnostic.html#cb11-31"></a>  ) <span class="op">+</span></span>
<span id="cb11-32"><a href="exploration-diagnostic.html#cb11-32"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(</span>
<span id="cb11-33"><a href="exploration-diagnostic.html#cb11-33"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb11-34"><a href="exploration-diagnostic.html#cb11-34"></a>  ) <span class="op">+</span></span>
<span id="cb11-35"><a href="exploration-diagnostic.html#cb11-35"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(</span>
<span id="cb11-36"><a href="exploration-diagnostic.html#cb11-36"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb11-37"><a href="exploration-diagnostic.html#cb11-37"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-38"><a href="exploration-diagnostic.html#cb11-38"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb11-39"><a href="exploration-diagnostic.html#cb11-39"></a>elite_final_performance_fig</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/final_performance_plot-1.png" width="672" /></p>
<p>These observations look fairly consistent with the timeseries plots.</p>
<p>Next, we output the results of our significance testing.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="exploration-diagnostic.html#cb12-1"></a>stat.test <span class="op">%&gt;%</span></span>
<span id="cb12-2"><a href="exploration-diagnostic.html#cb12-2"></a><span class="st">  </span><span class="kw">kbl</span>() <span class="op">%&gt;%</span></span>
<span id="cb12-3"><a href="exploration-diagnostic.html#cb12-3"></a><span class="st">  </span><span class="kw">kable_styling</span>(</span>
<span id="cb12-4"><a href="exploration-diagnostic.html#cb12-4"></a>    <span class="dt">bootstrap_options =</span> <span class="kw">c</span>(</span>
<span id="cb12-5"><a href="exploration-diagnostic.html#cb12-5"></a>      <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb12-6"><a href="exploration-diagnostic.html#cb12-6"></a>      <span class="st">&quot;hover&quot;</span>,</span>
<span id="cb12-7"><a href="exploration-diagnostic.html#cb12-7"></a>      <span class="st">&quot;condensed&quot;</span>,</span>
<span id="cb12-8"><a href="exploration-diagnostic.html#cb12-8"></a>      <span class="st">&quot;responsive&quot;</span></span>
<span id="cb12-9"><a href="exploration-diagnostic.html#cb12-9"></a>    )</span>
<span id="cb12-10"><a href="exploration-diagnostic.html#cb12-10"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb12-11"><a href="exploration-diagnostic.html#cb12-11"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width=</span><span class="st">&quot;600px&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:600px; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.y.
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:left;">
group2
</th>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p.adj
</th>
<th style="text-align:left;">
p.adj.signif
</th>
<th style="text-align:right;">
y.position
</th>
<th style="text-align:left;">
groups
</th>
<th style="text-align:right;">
xmin
</th>
<th style="text-align:right;">
xmax
</th>
<th style="text-align:left;">
label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1561
</td>
<td style="text-align:right;">
3.20e-02
</td>
<td style="text-align:right;">
3.20e-01
</td>
<td style="text-align:left;">
ns
</td>
<td style="text-align:right;">
1.922000
</td>
<td style="text-align:left;">
EcoEA , Fitness Sharing
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
p = 0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
2.946444
</td>
<td style="text-align:left;">
EcoEA , Lexicase
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2500
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
3.970889
</td>
<td style="text-align:left;">
EcoEA , Random
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1939
</td>
<td style="text-align:right;">
2.10e-06
</td>
<td style="text-align:right;">
2.07e-05
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
4.995333
</td>
<td style="text-align:left;">
EcoEA , Tournament
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
593
</td>
<td style="text-align:right;">
2.69e-05
</td>
<td style="text-align:right;">
2.69e-04
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:right;">
6.019778
</td>
<td style="text-align:left;">
Fitness Sharing, Lexicase
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p = 0.000269
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2500
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
7.044222
</td>
<td style="text-align:left;">
Fitness Sharing, Random
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1549
</td>
<td style="text-align:right;">
4.00e-02
</td>
<td style="text-align:right;">
4.00e-01
</td>
<td style="text-align:left;">
ns
</td>
<td style="text-align:right;">
8.068667
</td>
<td style="text-align:left;">
Fitness Sharing, Tournament
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p = 0.4
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2350
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
9.093111
</td>
<td style="text-align:left;">
Lexicase, Random
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2098
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
10.117556
</td>
<td style="text-align:left;">
Lexicase , Tournament
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
elite_trait_avg
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
11.142000
</td>
<td style="text-align:left;">
Random , Tournament
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="final-activation-position-coverage" class="section level4">
<h4><span class="header-section-number">2.2.2.2</span> Final activation position Coverage</h4>
<p>Now we do the same analysis for final activation position coverage.</p>
<p>First we calculate the statistics</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exploration-diagnostic.html#cb13-1"></a><span class="co"># Compute manual labels for geom_signif</span></span>
<span id="cb13-2"><a href="exploration-diagnostic.html#cb13-2"></a>stat.test &lt;-<span class="st"> </span>final_data <span class="op">%&gt;%</span></span>
<span id="cb13-3"><a href="exploration-diagnostic.html#cb13-3"></a><span class="st">  </span><span class="kw">wilcox_test</span>(unique_start_positions_coverage <span class="op">~</span><span class="st"> </span>selection_name) <span class="op">%&gt;%</span></span>
<span id="cb13-4"><a href="exploration-diagnostic.html#cb13-4"></a><span class="st">  </span><span class="kw">adjust_pvalue</span>(<span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb13-5"><a href="exploration-diagnostic.html#cb13-5"></a><span class="st">  </span><span class="kw">add_significance</span>() <span class="op">%&gt;%</span></span>
<span id="cb13-6"><a href="exploration-diagnostic.html#cb13-6"></a><span class="st">  </span><span class="kw">add_xy_position</span>(<span class="dt">x=</span><span class="st">&quot;selection_name&quot;</span>,<span class="dt">step.increase=</span><span class="dv">1</span>)</span>
<span id="cb13-7"><a href="exploration-diagnostic.html#cb13-7"></a>stat.test<span class="op">$</span>manual_position &lt;-<span class="st"> </span>stat.test<span class="op">$</span>y.position <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span></span>
<span id="cb13-8"><a href="exploration-diagnostic.html#cb13-8"></a>stat.test<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">mapply</span>(p_label,stat.test<span class="op">$</span>p.adj)</span></code></pre></div>
<p>Then we make raincloud plots</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="exploration-diagnostic.html#cb14-1"></a>unique_start_positions_coverage_final_fig &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb14-2"><a href="exploration-diagnostic.html#cb14-2"></a>    final_data,</span>
<span id="cb14-3"><a href="exploration-diagnostic.html#cb14-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb14-4"><a href="exploration-diagnostic.html#cb14-4"></a>      <span class="dt">x=</span>selection_name,</span>
<span id="cb14-5"><a href="exploration-diagnostic.html#cb14-5"></a>      <span class="dt">y=</span>unique_start_positions_coverage,</span>
<span id="cb14-6"><a href="exploration-diagnostic.html#cb14-6"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb14-7"><a href="exploration-diagnostic.html#cb14-7"></a>    )</span>
<span id="cb14-8"><a href="exploration-diagnostic.html#cb14-8"></a>  ) <span class="op">+</span></span>
<span id="cb14-9"><a href="exploration-diagnostic.html#cb14-9"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(</span>
<span id="cb14-10"><a href="exploration-diagnostic.html#cb14-10"></a>    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>),</span>
<span id="cb14-11"><a href="exploration-diagnostic.html#cb14-11"></a>    <span class="dt">alpha =</span> <span class="fl">.8</span>,</span>
<span id="cb14-12"><a href="exploration-diagnostic.html#cb14-12"></a>    <span class="dt">scale=</span><span class="st">&quot;width&quot;</span></span>
<span id="cb14-13"><a href="exploration-diagnostic.html#cb14-13"></a>  ) <span class="op">+</span></span>
<span id="cb14-14"><a href="exploration-diagnostic.html#cb14-14"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb14-15"><a href="exploration-diagnostic.html#cb14-15"></a>    <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>selection_name),</span>
<span id="cb14-16"><a href="exploration-diagnostic.html#cb14-16"></a>    <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.15</span>),</span>
<span id="cb14-17"><a href="exploration-diagnostic.html#cb14-17"></a>    <span class="dt">size =</span> <span class="fl">.5</span>,</span>
<span id="cb14-18"><a href="exploration-diagnostic.html#cb14-18"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb14-19"><a href="exploration-diagnostic.html#cb14-19"></a>  ) <span class="op">+</span></span>
<span id="cb14-20"><a href="exploration-diagnostic.html#cb14-20"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(</span>
<span id="cb14-21"><a href="exploration-diagnostic.html#cb14-21"></a>    <span class="dt">width =</span> <span class="fl">.1</span>,</span>
<span id="cb14-22"><a href="exploration-diagnostic.html#cb14-22"></a>    <span class="dt">outlier.shape =</span> <span class="ot">NA</span>,</span>
<span id="cb14-23"><a href="exploration-diagnostic.html#cb14-23"></a>    <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb14-24"><a href="exploration-diagnostic.html#cb14-24"></a>  ) <span class="op">+</span></span>
<span id="cb14-25"><a href="exploration-diagnostic.html#cb14-25"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb14-26"><a href="exploration-diagnostic.html#cb14-26"></a>    <span class="dt">name=</span><span class="st">&quot;Activation position coverage&quot;</span>,</span>
<span id="cb14-27"><a href="exploration-diagnostic.html#cb14-27"></a>    <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, coverage_ylim)</span>
<span id="cb14-28"><a href="exploration-diagnostic.html#cb14-28"></a>  ) <span class="op">+</span></span>
<span id="cb14-29"><a href="exploration-diagnostic.html#cb14-29"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(</span>
<span id="cb14-30"><a href="exploration-diagnostic.html#cb14-30"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb14-31"><a href="exploration-diagnostic.html#cb14-31"></a>  ) <span class="op">+</span></span>
<span id="cb14-32"><a href="exploration-diagnostic.html#cb14-32"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(</span>
<span id="cb14-33"><a href="exploration-diagnostic.html#cb14-33"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb14-34"><a href="exploration-diagnostic.html#cb14-34"></a>  ) <span class="op">+</span></span>
<span id="cb14-35"><a href="exploration-diagnostic.html#cb14-35"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(</span>
<span id="cb14-36"><a href="exploration-diagnostic.html#cb14-36"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb14-37"><a href="exploration-diagnostic.html#cb14-37"></a>  ) <span class="op">+</span></span>
<span id="cb14-38"><a href="exploration-diagnostic.html#cb14-38"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb14-39"><a href="exploration-diagnostic.html#cb14-39"></a>    <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span></span>
<span id="cb14-40"><a href="exploration-diagnostic.html#cb14-40"></a>  )</span>
<span id="cb14-41"><a href="exploration-diagnostic.html#cb14-41"></a>unique_start_positions_coverage_final_fig</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/unique_start_positions_final-1.png" width="672" /></p>
<p>These also look unsurprising.</p>
<p>Lastly, we output the results of significance testing.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exploration-diagnostic.html#cb15-1"></a>stat.test <span class="op">%&gt;%</span></span>
<span id="cb15-2"><a href="exploration-diagnostic.html#cb15-2"></a><span class="st">  </span><span class="kw">kbl</span>() <span class="op">%&gt;%</span></span>
<span id="cb15-3"><a href="exploration-diagnostic.html#cb15-3"></a><span class="st">  </span><span class="kw">kable_styling</span>(</span>
<span id="cb15-4"><a href="exploration-diagnostic.html#cb15-4"></a>    <span class="dt">bootstrap_options =</span> <span class="kw">c</span>(</span>
<span id="cb15-5"><a href="exploration-diagnostic.html#cb15-5"></a>      <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb15-6"><a href="exploration-diagnostic.html#cb15-6"></a>      <span class="st">&quot;hover&quot;</span>,</span>
<span id="cb15-7"><a href="exploration-diagnostic.html#cb15-7"></a>      <span class="st">&quot;condensed&quot;</span>,</span>
<span id="cb15-8"><a href="exploration-diagnostic.html#cb15-8"></a>      <span class="st">&quot;responsive&quot;</span></span>
<span id="cb15-9"><a href="exploration-diagnostic.html#cb15-9"></a>    )</span>
<span id="cb15-10"><a href="exploration-diagnostic.html#cb15-10"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb15-11"><a href="exploration-diagnostic.html#cb15-11"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width=</span><span class="st">&quot;600px&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:600px; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.y.
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:left;">
group2
</th>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p.adj
</th>
<th style="text-align:left;">
p.adj.signif
</th>
<th style="text-align:right;">
y.position
</th>
<th style="text-align:left;">
groups
</th>
<th style="text-align:right;">
xmin
</th>
<th style="text-align:right;">
xmax
</th>
<th style="text-align:right;">
manual_position
</th>
<th style="text-align:left;">
label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2392.5
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
1.420000
</td>
<td style="text-align:left;">
EcoEA , Fitness Sharing
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.491000
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
2.175556
</td>
<td style="text-align:left;">
EcoEA , Lexicase
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2.284333
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
339.0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
2.931111
</td>
<td style="text-align:left;">
EcoEA , Random
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3.077667
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2387.0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
3.686667
</td>
<td style="text-align:left;">
EcoEA , Tournament
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3.871000
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
4.442222
</td>
<td style="text-align:left;">
Fitness Sharing, Lexicase
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.664333
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
25.0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
5.197778
</td>
<td style="text-align:left;">
Fitness Sharing, Random
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5.457667
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1274.5
</td>
<td style="text-align:right;">
0.708
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
ns
</td>
<td style="text-align:right;">
5.953333
</td>
<td style="text-align:left;">
Fitness Sharing, Tournament
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6.251000
</td>
<td style="text-align:left;">
p = 1
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2350.0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
6.708889
</td>
<td style="text-align:left;">
Lexicase, Random
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7.044333
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2350.0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
7.464444
</td>
<td style="text-align:left;">
Lexicase , Tournament
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.837667
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
unique_start_positions_coverage
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2475.5
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
8.220000
</td>
<td style="text-align:left;">
Random , Tournament
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8.631000
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="phylogenetic-diversity" class="section level2">
<h2><span class="header-section-number">2.3</span> Phylogenetic diversity</h2>
<p>Next, we analyze the behavior of phylogenetic diversity on the exploration diagnostic.</p>
<div id="over-time-1" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Over time</h3>
<p>First we plot mean pairwise distance over time. We log the y axis because there is such variation in mean pairwise distance across selection schemes.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="exploration-diagnostic.html#cb16-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb16-2"><a href="exploration-diagnostic.html#cb16-2"></a>    data,</span>
<span id="cb16-3"><a href="exploration-diagnostic.html#cb16-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb16-4"><a href="exploration-diagnostic.html#cb16-4"></a>      <span class="dt">x=</span>gen,</span>
<span id="cb16-5"><a href="exploration-diagnostic.html#cb16-5"></a>      <span class="dt">y=</span>mean_phenotype_pairwise_distance,</span>
<span id="cb16-6"><a href="exploration-diagnostic.html#cb16-6"></a>      <span class="dt">color=</span>selection_name,</span>
<span id="cb16-7"><a href="exploration-diagnostic.html#cb16-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb16-8"><a href="exploration-diagnostic.html#cb16-8"></a>    )</span>
<span id="cb16-9"><a href="exploration-diagnostic.html#cb16-9"></a>  ) <span class="op">+</span></span>
<span id="cb16-10"><a href="exploration-diagnostic.html#cb16-10"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun=</span>mean) <span class="op">+</span></span>
<span id="cb16-11"><a href="exploration-diagnostic.html#cb16-11"></a><span class="st">  </span><span class="kw">stat_summary</span>(</span>
<span id="cb16-12"><a href="exploration-diagnostic.html#cb16-12"></a>    <span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>,</span>
<span id="cb16-13"><a href="exploration-diagnostic.html#cb16-13"></a>    <span class="dt">fun.data=</span><span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb16-14"><a href="exploration-diagnostic.html#cb16-14"></a>    <span class="dt">fun.args=</span><span class="kw">list</span>(<span class="dt">conf.int=</span><span class="fl">0.95</span>),</span>
<span id="cb16-15"><a href="exploration-diagnostic.html#cb16-15"></a>    <span class="dt">alpha=</span><span class="fl">0.2</span>,</span>
<span id="cb16-16"><a href="exploration-diagnostic.html#cb16-16"></a>    <span class="dt">linetype=</span><span class="dv">0</span></span>
<span id="cb16-17"><a href="exploration-diagnostic.html#cb16-17"></a>  ) <span class="op">+</span></span>
<span id="cb16-18"><a href="exploration-diagnostic.html#cb16-18"></a><span class="st">  </span><span class="kw">scale_y_log10</span>(</span>
<span id="cb16-19"><a href="exploration-diagnostic.html#cb16-19"></a>    <span class="dt">name=</span><span class="st">&quot;Mean pairwise distance&quot;</span></span>
<span id="cb16-20"><a href="exploration-diagnostic.html#cb16-20"></a>  ) <span class="op">+</span></span>
<span id="cb16-21"><a href="exploration-diagnostic.html#cb16-21"></a><span class="st">  </span><span class="kw">scale_x_log10</span>(</span>
<span id="cb16-22"><a href="exploration-diagnostic.html#cb16-22"></a>    <span class="dt">name=</span><span class="st">&quot;Generation&quot;</span></span>
<span id="cb16-23"><a href="exploration-diagnostic.html#cb16-23"></a>  ) <span class="op">+</span></span>
<span id="cb16-24"><a href="exploration-diagnostic.html#cb16-24"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;Selection&quot;</span>) <span class="op">+</span></span>
<span id="cb16-25"><a href="exploration-diagnostic.html#cb16-25"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="st">&quot;Selection&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phylogeny_over_time_plot_mpd-1.png" width="672" /></p>
<p>Lexicase selection maintains a monotonic increase in phylogenetic diversity over the course of the entire experiment. It likely never experiences a full coalesence event (where the most-recent common ancestor changes). Eco-EA nearly keeps pace with lexicase selection until towards the end, when its phylogenetic diversity crashes. This is likely the result of selective sweeps that begin to occur as the population discovers high fitness solutions. Fitness sharing shows a slight dip at the same time that its fitness plateaus (likely also the result of a selective sweep), but phylogenetic diversity recovers afterwards, making for a relatively constant level. over time. Tournament selection, on the other hand, maintains the same (low) level of phylogenetic diversity as fitness sharing, up until the point that fitness plateaus, at which point tournament selection’s phylodiversity drops to nearly 0. Interestingly, lexicase selection and Eco-EA both maintain more phylodiversity than random selection, whereas fitness sharing and tournament selection maintain less.</p>
<p>For comparison, we make the same plot with mean evolutionary distinctiveness.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="exploration-diagnostic.html#cb17-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb17-2"><a href="exploration-diagnostic.html#cb17-2"></a>    data,</span>
<span id="cb17-3"><a href="exploration-diagnostic.html#cb17-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb17-4"><a href="exploration-diagnostic.html#cb17-4"></a>      <span class="dt">x=</span>gen,</span>
<span id="cb17-5"><a href="exploration-diagnostic.html#cb17-5"></a>      <span class="dt">y=</span>mean_phenotype_evolutionary_distinctiveness,</span>
<span id="cb17-6"><a href="exploration-diagnostic.html#cb17-6"></a>      <span class="dt">color=</span>selection_name,</span>
<span id="cb17-7"><a href="exploration-diagnostic.html#cb17-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb17-8"><a href="exploration-diagnostic.html#cb17-8"></a>    )</span>
<span id="cb17-9"><a href="exploration-diagnostic.html#cb17-9"></a>  ) <span class="op">+</span></span>
<span id="cb17-10"><a href="exploration-diagnostic.html#cb17-10"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun=</span>mean) <span class="op">+</span></span>
<span id="cb17-11"><a href="exploration-diagnostic.html#cb17-11"></a><span class="st">  </span><span class="kw">stat_summary</span>(</span>
<span id="cb17-12"><a href="exploration-diagnostic.html#cb17-12"></a>    <span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>,</span>
<span id="cb17-13"><a href="exploration-diagnostic.html#cb17-13"></a>    <span class="dt">fun.data=</span><span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb17-14"><a href="exploration-diagnostic.html#cb17-14"></a>    <span class="dt">fun.args=</span><span class="kw">list</span>(<span class="dt">conf.int=</span><span class="fl">0.95</span>),</span>
<span id="cb17-15"><a href="exploration-diagnostic.html#cb17-15"></a>    <span class="dt">alpha=</span><span class="fl">0.2</span>,</span>
<span id="cb17-16"><a href="exploration-diagnostic.html#cb17-16"></a>    <span class="dt">linetype=</span><span class="dv">0</span></span>
<span id="cb17-17"><a href="exploration-diagnostic.html#cb17-17"></a>  ) <span class="op">+</span></span>
<span id="cb17-18"><a href="exploration-diagnostic.html#cb17-18"></a><span class="st">  </span><span class="kw">scale_y_log10</span>(</span>
<span id="cb17-19"><a href="exploration-diagnostic.html#cb17-19"></a>    <span class="dt">name=</span><span class="st">&quot;Mean evolutionary distinctiveness&quot;</span></span>
<span id="cb17-20"><a href="exploration-diagnostic.html#cb17-20"></a>  ) <span class="op">+</span></span>
<span id="cb17-21"><a href="exploration-diagnostic.html#cb17-21"></a><span class="st">  </span><span class="kw">scale_x_log10</span>(</span>
<span id="cb17-22"><a href="exploration-diagnostic.html#cb17-22"></a>    <span class="dt">name=</span><span class="st">&quot;Generation&quot;</span></span>
<span id="cb17-23"><a href="exploration-diagnostic.html#cb17-23"></a>  ) <span class="op">+</span></span>
<span id="cb17-24"><a href="exploration-diagnostic.html#cb17-24"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;Selection&quot;</span>) <span class="op">+</span></span>
<span id="cb17-25"><a href="exploration-diagnostic.html#cb17-25"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="st">&quot;Selection&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phylogeny_over_time_plot_med-1.png" width="672" /></p>
</div>
<div id="final-1" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Final</h3>
<p>Next, we perform a more in-depth analysis of phylodiversity distributions at the final time point.</p>
<div id="mean-pairwise-distance" class="section level4">
<h4><span class="header-section-number">2.3.2.1</span> Mean pairwise distance</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="exploration-diagnostic.html#cb18-1"></a><span class="co"># Pairwise wilcoxon teset to determine which conditions are significantly different from each other</span></span>
<span id="cb18-2"><a href="exploration-diagnostic.html#cb18-2"></a>stat.test &lt;-<span class="st"> </span>final_data <span class="op">%&gt;%</span></span>
<span id="cb18-3"><a href="exploration-diagnostic.html#cb18-3"></a><span class="st">  </span><span class="kw">wilcox_test</span>(mean_phenotype_pairwise_distance <span class="op">~</span><span class="st"> </span>selection_name) <span class="op">%&gt;%</span></span>
<span id="cb18-4"><a href="exploration-diagnostic.html#cb18-4"></a><span class="st">  </span><span class="kw">adjust_pvalue</span>(<span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb18-5"><a href="exploration-diagnostic.html#cb18-5"></a><span class="st">  </span><span class="kw">add_significance</span>() <span class="op">%&gt;%</span></span>
<span id="cb18-6"><a href="exploration-diagnostic.html#cb18-6"></a><span class="st">  </span><span class="kw">add_xy_position</span>(<span class="dt">x=</span><span class="st">&quot;selection_name&quot;</span>,<span class="dt">step.increase=</span><span class="dv">1</span>)</span>
<span id="cb18-7"><a href="exploration-diagnostic.html#cb18-7"></a>stat.test<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">mapply</span>(p_label,stat.test<span class="op">$</span>p.adj)</span>
<span id="cb18-8"><a href="exploration-diagnostic.html#cb18-8"></a></span>
<span id="cb18-9"><a href="exploration-diagnostic.html#cb18-9"></a><span class="co"># Output stats</span></span>
<span id="cb18-10"><a href="exploration-diagnostic.html#cb18-10"></a>stat.test <span class="op">%&gt;%</span></span>
<span id="cb18-11"><a href="exploration-diagnostic.html#cb18-11"></a><span class="st">  </span><span class="kw">kbl</span>() <span class="op">%&gt;%</span></span>
<span id="cb18-12"><a href="exploration-diagnostic.html#cb18-12"></a><span class="st">  </span><span class="kw">kable_styling</span>(</span>
<span id="cb18-13"><a href="exploration-diagnostic.html#cb18-13"></a>    <span class="dt">bootstrap_options =</span> <span class="kw">c</span>(</span>
<span id="cb18-14"><a href="exploration-diagnostic.html#cb18-14"></a>      <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb18-15"><a href="exploration-diagnostic.html#cb18-15"></a>      <span class="st">&quot;hover&quot;</span>,</span>
<span id="cb18-16"><a href="exploration-diagnostic.html#cb18-16"></a>      <span class="st">&quot;condensed&quot;</span>,</span>
<span id="cb18-17"><a href="exploration-diagnostic.html#cb18-17"></a>      <span class="st">&quot;responsive&quot;</span></span>
<span id="cb18-18"><a href="exploration-diagnostic.html#cb18-18"></a>    )</span>
<span id="cb18-19"><a href="exploration-diagnostic.html#cb18-19"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb18-20"><a href="exploration-diagnostic.html#cb18-20"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width=</span><span class="st">&quot;600px&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:600px; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.y.
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:left;">
group2
</th>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p.adj
</th>
<th style="text-align:left;">
p.adj.signif
</th>
<th style="text-align:right;">
y.position
</th>
<th style="text-align:left;">
groups
</th>
<th style="text-align:right;">
xmin
</th>
<th style="text-align:right;">
xmax
</th>
<th style="text-align:left;">
label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1824.0
</td>
<td style="text-align:right;">
7.70e-05
</td>
<td style="text-align:right;">
7.70e-04
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:right;">
49488.81
</td>
<td style="text-align:left;">
EcoEA , Fitness Sharing
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
p = 0.00077
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
227.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
76981.49
</td>
<td style="text-align:left;">
EcoEA , Lexicase
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
690.0
</td>
<td style="text-align:right;">
1.15e-04
</td>
<td style="text-align:right;">
1.15e-03
</td>
<td style="text-align:left;">
**
</td>
<td style="text-align:right;">
104474.18
</td>
<td style="text-align:left;">
EcoEA , Random
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p = 0.00115
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2500.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
131966.86
</td>
<td style="text-align:left;">
EcoEA , Tournament
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
159459.54
</td>
<td style="text-align:left;">
Fitness Sharing, Lexicase
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
536.0
</td>
<td style="text-align:right;">
9.00e-07
</td>
<td style="text-align:right;">
8.70e-06
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
186952.22
</td>
<td style="text-align:left;">
Fitness Sharing, Random
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2232.5
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
214444.90
</td>
<td style="text-align:left;">
Fitness Sharing, Tournament
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2350.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
241937.58
</td>
<td style="text-align:left;">
Lexicase, Random
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2350.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
269430.26
</td>
<td style="text-align:left;">
Lexicase , Tournament
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_pairwise_distance
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2500.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
296922.94
</td>
<td style="text-align:left;">
Random , Tournament
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="exploration-diagnostic.html#cb19-1"></a><span class="co"># Raincloud plot of final mean pairwise distance</span></span>
<span id="cb19-2"><a href="exploration-diagnostic.html#cb19-2"></a>final_phylogeny_fig &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb19-3"><a href="exploration-diagnostic.html#cb19-3"></a>    final_data,</span>
<span id="cb19-4"><a href="exploration-diagnostic.html#cb19-4"></a>    <span class="kw">aes</span>(</span>
<span id="cb19-5"><a href="exploration-diagnostic.html#cb19-5"></a>      <span class="dt">x=</span>selection_name,</span>
<span id="cb19-6"><a href="exploration-diagnostic.html#cb19-6"></a>      <span class="dt">y=</span>mean_phenotype_pairwise_distance,</span>
<span id="cb19-7"><a href="exploration-diagnostic.html#cb19-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb19-8"><a href="exploration-diagnostic.html#cb19-8"></a>    )</span>
<span id="cb19-9"><a href="exploration-diagnostic.html#cb19-9"></a>  ) <span class="op">+</span></span>
<span id="cb19-10"><a href="exploration-diagnostic.html#cb19-10"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(</span>
<span id="cb19-11"><a href="exploration-diagnostic.html#cb19-11"></a>    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>),</span>
<span id="cb19-12"><a href="exploration-diagnostic.html#cb19-12"></a>    <span class="dt">alpha =</span> <span class="fl">.8</span>,</span>
<span id="cb19-13"><a href="exploration-diagnostic.html#cb19-13"></a>    <span class="dt">scale=</span><span class="st">&quot;width&quot;</span></span>
<span id="cb19-14"><a href="exploration-diagnostic.html#cb19-14"></a>  ) <span class="op">+</span></span>
<span id="cb19-15"><a href="exploration-diagnostic.html#cb19-15"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb19-16"><a href="exploration-diagnostic.html#cb19-16"></a>    <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>selection_name),</span>
<span id="cb19-17"><a href="exploration-diagnostic.html#cb19-17"></a>    <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.15</span>),</span>
<span id="cb19-18"><a href="exploration-diagnostic.html#cb19-18"></a>    <span class="dt">size =</span> <span class="fl">.5</span>,</span>
<span id="cb19-19"><a href="exploration-diagnostic.html#cb19-19"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb19-20"><a href="exploration-diagnostic.html#cb19-20"></a>  ) <span class="op">+</span></span>
<span id="cb19-21"><a href="exploration-diagnostic.html#cb19-21"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(</span>
<span id="cb19-22"><a href="exploration-diagnostic.html#cb19-22"></a>    <span class="dt">width =</span> <span class="fl">.1</span>,</span>
<span id="cb19-23"><a href="exploration-diagnostic.html#cb19-23"></a>    <span class="dt">outlier.shape =</span> <span class="ot">NA</span>,</span>
<span id="cb19-24"><a href="exploration-diagnostic.html#cb19-24"></a>    <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb19-25"><a href="exploration-diagnostic.html#cb19-25"></a>  ) <span class="op">+</span></span>
<span id="cb19-26"><a href="exploration-diagnostic.html#cb19-26"></a><span class="st">  </span><span class="kw">scale_y_log10</span>(</span>
<span id="cb19-27"><a href="exploration-diagnostic.html#cb19-27"></a>    <span class="dt">name=</span><span class="st">&quot;Mean pairwise distance&quot;</span></span>
<span id="cb19-28"><a href="exploration-diagnostic.html#cb19-28"></a>  ) <span class="op">+</span></span>
<span id="cb19-29"><a href="exploration-diagnostic.html#cb19-29"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(</span>
<span id="cb19-30"><a href="exploration-diagnostic.html#cb19-30"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb19-31"><a href="exploration-diagnostic.html#cb19-31"></a>  ) <span class="op">+</span></span>
<span id="cb19-32"><a href="exploration-diagnostic.html#cb19-32"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(</span>
<span id="cb19-33"><a href="exploration-diagnostic.html#cb19-33"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb19-34"><a href="exploration-diagnostic.html#cb19-34"></a>  ) <span class="op">+</span></span>
<span id="cb19-35"><a href="exploration-diagnostic.html#cb19-35"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(</span>
<span id="cb19-36"><a href="exploration-diagnostic.html#cb19-36"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb19-37"><a href="exploration-diagnostic.html#cb19-37"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-38"><a href="exploration-diagnostic.html#cb19-38"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb19-39"><a href="exploration-diagnostic.html#cb19-39"></a>final_phylogeny_fig</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/final_phylogeny_plot_mpd-1.png" width="672" /></p>
<p>This shows something interesting! Final phylogenetic diversity in Eco-EA is heavily bimodal. In later analysis, we will see that the runs with high phylogenetic diversity are the ones with lower fitness, suggesting that they have no yet experienced a selective sweep resulting from the discovery of a high-fitness solution.</p>
</div>
<div id="mean-evolutionary-distinctiveness" class="section level4">
<h4><span class="header-section-number">2.3.2.2</span> Mean evolutionary distinctiveness</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="exploration-diagnostic.html#cb20-1"></a><span class="co"># Pairwise wilcoxon teset to determine which conditions are significantly different from each other</span></span>
<span id="cb20-2"><a href="exploration-diagnostic.html#cb20-2"></a>stat.test &lt;-<span class="st"> </span>final_data <span class="op">%&gt;%</span></span>
<span id="cb20-3"><a href="exploration-diagnostic.html#cb20-3"></a><span class="st">  </span><span class="kw">wilcox_test</span>(mean_phenotype_evolutionary_distinctiveness <span class="op">~</span><span class="st"> </span>selection_name) <span class="op">%&gt;%</span></span>
<span id="cb20-4"><a href="exploration-diagnostic.html#cb20-4"></a><span class="st">  </span><span class="kw">adjust_pvalue</span>(<span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb20-5"><a href="exploration-diagnostic.html#cb20-5"></a><span class="st">  </span><span class="kw">add_significance</span>() <span class="op">%&gt;%</span></span>
<span id="cb20-6"><a href="exploration-diagnostic.html#cb20-6"></a><span class="st">  </span><span class="kw">add_xy_position</span>(<span class="dt">x=</span><span class="st">&quot;selection_name&quot;</span>,<span class="dt">step.increase=</span><span class="dv">1</span>)</span>
<span id="cb20-7"><a href="exploration-diagnostic.html#cb20-7"></a>stat.test<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">mapply</span>(p_label,stat.test<span class="op">$</span>p.adj)</span>
<span id="cb20-8"><a href="exploration-diagnostic.html#cb20-8"></a></span>
<span id="cb20-9"><a href="exploration-diagnostic.html#cb20-9"></a><span class="co"># Output stats</span></span>
<span id="cb20-10"><a href="exploration-diagnostic.html#cb20-10"></a></span>
<span id="cb20-11"><a href="exploration-diagnostic.html#cb20-11"></a>stat.test <span class="op">%&gt;%</span></span>
<span id="cb20-12"><a href="exploration-diagnostic.html#cb20-12"></a><span class="st">  </span><span class="kw">kbl</span>() <span class="op">%&gt;%</span></span>
<span id="cb20-13"><a href="exploration-diagnostic.html#cb20-13"></a><span class="st">  </span><span class="kw">kable_styling</span>(</span>
<span id="cb20-14"><a href="exploration-diagnostic.html#cb20-14"></a>    <span class="dt">bootstrap_options =</span> <span class="kw">c</span>(</span>
<span id="cb20-15"><a href="exploration-diagnostic.html#cb20-15"></a>      <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb20-16"><a href="exploration-diagnostic.html#cb20-16"></a>      <span class="st">&quot;hover&quot;</span>,</span>
<span id="cb20-17"><a href="exploration-diagnostic.html#cb20-17"></a>      <span class="st">&quot;condensed&quot;</span>,</span>
<span id="cb20-18"><a href="exploration-diagnostic.html#cb20-18"></a>      <span class="st">&quot;responsive&quot;</span></span>
<span id="cb20-19"><a href="exploration-diagnostic.html#cb20-19"></a>    )</span>
<span id="cb20-20"><a href="exploration-diagnostic.html#cb20-20"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb20-21"><a href="exploration-diagnostic.html#cb20-21"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width=</span><span class="st">&quot;600px&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:600px; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.y.
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:left;">
group2
</th>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p.adj
</th>
<th style="text-align:left;">
p.adj.signif
</th>
<th style="text-align:right;">
y.position
</th>
<th style="text-align:left;">
groups
</th>
<th style="text-align:right;">
xmin
</th>
<th style="text-align:right;">
xmax
</th>
<th style="text-align:left;">
label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
469
</td>
<td style="text-align:right;">
1.00e-07
</td>
<td style="text-align:right;">
7.00e-07
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
289111.7
</td>
<td style="text-align:left;">
EcoEA , Fitness Sharing
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
449625.8
</td>
<td style="text-align:left;">
EcoEA , Lexicase
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
711
</td>
<td style="text-align:right;">
2.05e-04
</td>
<td style="text-align:right;">
2.05e-03
</td>
<td style="text-align:left;">
**
</td>
<td style="text-align:right;">
610140.0
</td>
<td style="text-align:left;">
EcoEA , Random
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p = 0.00205
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
569
</td>
<td style="text-align:right;">
2.70e-06
</td>
<td style="text-align:right;">
2.72e-05
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
770654.1
</td>
<td style="text-align:left;">
EcoEA , Tournament
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
931168.2
</td>
<td style="text-align:left;">
Fitness Sharing, Lexicase
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2428
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
1091682.4
</td>
<td style="text-align:left;">
Fitness Sharing, Random
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1614
</td>
<td style="text-align:right;">
1.20e-02
</td>
<td style="text-align:right;">
1.20e-01
</td>
<td style="text-align:left;">
ns
</td>
<td style="text-align:right;">
1252196.5
</td>
<td style="text-align:left;">
Fitness Sharing, Tournament
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p = 0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2350
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
1412710.6
</td>
<td style="text-align:left;">
Lexicase, Random
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2255
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
1573224.7
</td>
<td style="text-align:left;">
Lexicase , Tournament
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_phenotype_evolutionary_distinctiveness
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
1733738.9
</td>
<td style="text-align:left;">
Random , Tournament
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="exploration-diagnostic.html#cb21-1"></a><span class="co"># Raincloud plot of final mean evolutionary distinctiveness</span></span>
<span id="cb21-2"><a href="exploration-diagnostic.html#cb21-2"></a><span class="kw">ggplot</span>(</span>
<span id="cb21-3"><a href="exploration-diagnostic.html#cb21-3"></a>    final_data,</span>
<span id="cb21-4"><a href="exploration-diagnostic.html#cb21-4"></a>    <span class="kw">aes</span>(</span>
<span id="cb21-5"><a href="exploration-diagnostic.html#cb21-5"></a>      <span class="dt">x=</span>selection_name,</span>
<span id="cb21-6"><a href="exploration-diagnostic.html#cb21-6"></a>      <span class="dt">y=</span>mean_phenotype_evolutionary_distinctiveness,</span>
<span id="cb21-7"><a href="exploration-diagnostic.html#cb21-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb21-8"><a href="exploration-diagnostic.html#cb21-8"></a>    )</span>
<span id="cb21-9"><a href="exploration-diagnostic.html#cb21-9"></a>  ) <span class="op">+</span></span>
<span id="cb21-10"><a href="exploration-diagnostic.html#cb21-10"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(</span>
<span id="cb21-11"><a href="exploration-diagnostic.html#cb21-11"></a>    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>),</span>
<span id="cb21-12"><a href="exploration-diagnostic.html#cb21-12"></a>    <span class="dt">alpha =</span> <span class="fl">.8</span>,</span>
<span id="cb21-13"><a href="exploration-diagnostic.html#cb21-13"></a>    <span class="dt">scale=</span><span class="st">&quot;width&quot;</span></span>
<span id="cb21-14"><a href="exploration-diagnostic.html#cb21-14"></a>  ) <span class="op">+</span></span>
<span id="cb21-15"><a href="exploration-diagnostic.html#cb21-15"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb21-16"><a href="exploration-diagnostic.html#cb21-16"></a>    <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>selection_name),</span>
<span id="cb21-17"><a href="exploration-diagnostic.html#cb21-17"></a>    <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.15</span>),</span>
<span id="cb21-18"><a href="exploration-diagnostic.html#cb21-18"></a>    <span class="dt">size =</span> <span class="fl">.5</span>,</span>
<span id="cb21-19"><a href="exploration-diagnostic.html#cb21-19"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb21-20"><a href="exploration-diagnostic.html#cb21-20"></a>  ) <span class="op">+</span></span>
<span id="cb21-21"><a href="exploration-diagnostic.html#cb21-21"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(</span>
<span id="cb21-22"><a href="exploration-diagnostic.html#cb21-22"></a>    <span class="dt">width =</span> <span class="fl">.1</span>,</span>
<span id="cb21-23"><a href="exploration-diagnostic.html#cb21-23"></a>    <span class="dt">outlier.shape =</span> <span class="ot">NA</span>,</span>
<span id="cb21-24"><a href="exploration-diagnostic.html#cb21-24"></a>    <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb21-25"><a href="exploration-diagnostic.html#cb21-25"></a>  ) <span class="op">+</span></span>
<span id="cb21-26"><a href="exploration-diagnostic.html#cb21-26"></a><span class="st">  </span><span class="kw">scale_y_log10</span>(</span>
<span id="cb21-27"><a href="exploration-diagnostic.html#cb21-27"></a>    <span class="dt">name=</span><span class="st">&quot;Mean evolutionary distinctiveness&quot;</span></span>
<span id="cb21-28"><a href="exploration-diagnostic.html#cb21-28"></a>  ) <span class="op">+</span></span>
<span id="cb21-29"><a href="exploration-diagnostic.html#cb21-29"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(</span>
<span id="cb21-30"><a href="exploration-diagnostic.html#cb21-30"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb21-31"><a href="exploration-diagnostic.html#cb21-31"></a>  ) <span class="op">+</span></span>
<span id="cb21-32"><a href="exploration-diagnostic.html#cb21-32"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(</span>
<span id="cb21-33"><a href="exploration-diagnostic.html#cb21-33"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb21-34"><a href="exploration-diagnostic.html#cb21-34"></a>  ) <span class="op">+</span></span>
<span id="cb21-35"><a href="exploration-diagnostic.html#cb21-35"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(</span>
<span id="cb21-36"><a href="exploration-diagnostic.html#cb21-36"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb21-37"><a href="exploration-diagnostic.html#cb21-37"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-38"><a href="exploration-diagnostic.html#cb21-38"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/final_phylogeny_plot_med-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="phenotypic-diversity" class="section level2">
<h2><span class="header-section-number">2.4</span> Phenotypic diversity</h2>
<div id="relationship-between-different-types-of-phenotypic-diversity" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Relationship between different types of phenotypic diversity</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="exploration-diagnostic.html#cb22-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb22-2"><a href="exploration-diagnostic.html#cb22-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">500000</span>),</span>
<span id="cb22-3"><a href="exploration-diagnostic.html#cb22-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb22-4"><a href="exploration-diagnostic.html#cb22-4"></a>        <span class="dt">y=</span>phen_diversity,</span>
<span id="cb22-5"><a href="exploration-diagnostic.html#cb22-5"></a>        <span class="dt">x=</span>phen_num_taxa,</span>
<span id="cb22-6"><a href="exploration-diagnostic.html#cb22-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb22-7"><a href="exploration-diagnostic.html#cb22-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb22-8"><a href="exploration-diagnostic.html#cb22-8"></a>    )</span>
<span id="cb22-9"><a href="exploration-diagnostic.html#cb22-9"></a>  ) <span class="op">+</span></span>
<span id="cb22-10"><a href="exploration-diagnostic.html#cb22-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb22-11"><a href="exploration-diagnostic.html#cb22-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb22-12"><a href="exploration-diagnostic.html#cb22-12"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic shannon diversity&quot;</span></span>
<span id="cb22-13"><a href="exploration-diagnostic.html#cb22-13"></a>  ) <span class="op">+</span></span>
<span id="cb22-14"><a href="exploration-diagnostic.html#cb22-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb22-15"><a href="exploration-diagnostic.html#cb22-15"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic richness&quot;</span>,</span>
<span id="cb22-16"><a href="exploration-diagnostic.html#cb22-16"></a>        <span class="dt">breaks =</span> <span class="kw">breaks_extended</span>(<span class="dv">4</span>)</span>
<span id="cb22-17"><a href="exploration-diagnostic.html#cb22-17"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-18"><a href="exploration-diagnostic.html#cb22-18"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb22-19"><a href="exploration-diagnostic.html#cb22-19"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb22-20"><a href="exploration-diagnostic.html#cb22-20"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-21"><a href="exploration-diagnostic.html#cb22-21"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb22-22"><a href="exploration-diagnostic.html#cb22-22"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb22-23"><a href="exploration-diagnostic.html#cb22-23"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-24"><a href="exploration-diagnostic.html#cb22-24"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb22-25"><a href="exploration-diagnostic.html#cb22-25"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb22-26"><a href="exploration-diagnostic.html#cb22-26"></a>  ) <span class="op">+</span></span>
<span id="cb22-27"><a href="exploration-diagnostic.html#cb22-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/richness_vs_shannon-1.png" width="672" /></p>
</div>
<div id="over-time-2" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Over time</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="exploration-diagnostic.html#cb23-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb23-2"><a href="exploration-diagnostic.html#cb23-2"></a>    data,</span>
<span id="cb23-3"><a href="exploration-diagnostic.html#cb23-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb23-4"><a href="exploration-diagnostic.html#cb23-4"></a>      <span class="dt">x=</span>gen,</span>
<span id="cb23-5"><a href="exploration-diagnostic.html#cb23-5"></a>      <span class="dt">y=</span>phen_num_taxa,</span>
<span id="cb23-6"><a href="exploration-diagnostic.html#cb23-6"></a>      <span class="dt">color=</span>selection_name,</span>
<span id="cb23-7"><a href="exploration-diagnostic.html#cb23-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb23-8"><a href="exploration-diagnostic.html#cb23-8"></a>    )</span>
<span id="cb23-9"><a href="exploration-diagnostic.html#cb23-9"></a>  ) <span class="op">+</span></span>
<span id="cb23-10"><a href="exploration-diagnostic.html#cb23-10"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun=</span>mean) <span class="op">+</span></span>
<span id="cb23-11"><a href="exploration-diagnostic.html#cb23-11"></a><span class="st">  </span><span class="kw">stat_summary</span>(</span>
<span id="cb23-12"><a href="exploration-diagnostic.html#cb23-12"></a>    <span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>,</span>
<span id="cb23-13"><a href="exploration-diagnostic.html#cb23-13"></a>    <span class="dt">fun.data=</span><span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb23-14"><a href="exploration-diagnostic.html#cb23-14"></a>    <span class="dt">fun.args=</span><span class="kw">list</span>(<span class="dt">conf.int=</span><span class="fl">0.95</span>),</span>
<span id="cb23-15"><a href="exploration-diagnostic.html#cb23-15"></a>    <span class="dt">alpha=</span><span class="fl">0.2</span>,</span>
<span id="cb23-16"><a href="exploration-diagnostic.html#cb23-16"></a>    <span class="dt">linetype=</span><span class="dv">0</span></span>
<span id="cb23-17"><a href="exploration-diagnostic.html#cb23-17"></a>  ) <span class="op">+</span></span>
<span id="cb23-18"><a href="exploration-diagnostic.html#cb23-18"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb23-19"><a href="exploration-diagnostic.html#cb23-19"></a>    <span class="dt">name=</span><span class="st">&quot;Phenotypic richness&quot;</span></span>
<span id="cb23-20"><a href="exploration-diagnostic.html#cb23-20"></a>  ) <span class="op">+</span></span>
<span id="cb23-21"><a href="exploration-diagnostic.html#cb23-21"></a><span class="st">  </span><span class="kw">scale_x_log10</span>(</span>
<span id="cb23-22"><a href="exploration-diagnostic.html#cb23-22"></a>    <span class="dt">name=</span><span class="st">&quot;Generation&quot;</span></span>
<span id="cb23-23"><a href="exploration-diagnostic.html#cb23-23"></a>  ) <span class="op">+</span></span>
<span id="cb23-24"><a href="exploration-diagnostic.html#cb23-24"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;Selection&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-25"><a href="exploration-diagnostic.html#cb23-25"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="st">&quot;Selection&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phenotypic_diversity_over_time_plot-1.png" width="672" /></p>
<p>In contrast to the phylodiversity results, phenotypic richness in all selection schemes (even tournament selection) ultimately exceeds that of random selection. Eco-EA monotonically increases while lexicase selection reaches a maximum around the same time it reaches its fitness plateau. The only real similarity to the phylodiversity results is the behavior tournament selection and fitness sharing relative to each other.</p>
<p>We also looked at phenotypic shannon entropy:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="exploration-diagnostic.html#cb24-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb24-2"><a href="exploration-diagnostic.html#cb24-2"></a>    data,</span>
<span id="cb24-3"><a href="exploration-diagnostic.html#cb24-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb24-4"><a href="exploration-diagnostic.html#cb24-4"></a>      <span class="dt">x=</span>gen,</span>
<span id="cb24-5"><a href="exploration-diagnostic.html#cb24-5"></a>      <span class="dt">y=</span>phen_diversity,</span>
<span id="cb24-6"><a href="exploration-diagnostic.html#cb24-6"></a>      <span class="dt">color=</span>selection_name,</span>
<span id="cb24-7"><a href="exploration-diagnostic.html#cb24-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb24-8"><a href="exploration-diagnostic.html#cb24-8"></a>    )</span>
<span id="cb24-9"><a href="exploration-diagnostic.html#cb24-9"></a>  ) <span class="op">+</span></span>
<span id="cb24-10"><a href="exploration-diagnostic.html#cb24-10"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun=</span>mean) <span class="op">+</span></span>
<span id="cb24-11"><a href="exploration-diagnostic.html#cb24-11"></a><span class="st">  </span><span class="kw">stat_summary</span>(</span>
<span id="cb24-12"><a href="exploration-diagnostic.html#cb24-12"></a>    <span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>,</span>
<span id="cb24-13"><a href="exploration-diagnostic.html#cb24-13"></a>    <span class="dt">fun.data=</span><span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb24-14"><a href="exploration-diagnostic.html#cb24-14"></a>    <span class="dt">fun.args=</span><span class="kw">list</span>(<span class="dt">conf.int=</span><span class="fl">0.95</span>),</span>
<span id="cb24-15"><a href="exploration-diagnostic.html#cb24-15"></a>    <span class="dt">alpha=</span><span class="fl">0.2</span>,</span>
<span id="cb24-16"><a href="exploration-diagnostic.html#cb24-16"></a>    <span class="dt">linetype=</span><span class="dv">0</span></span>
<span id="cb24-17"><a href="exploration-diagnostic.html#cb24-17"></a>  ) <span class="op">+</span></span>
<span id="cb24-18"><a href="exploration-diagnostic.html#cb24-18"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb24-19"><a href="exploration-diagnostic.html#cb24-19"></a>    <span class="dt">name=</span><span class="st">&quot;Phenotypic Shannon entropy&quot;</span></span>
<span id="cb24-20"><a href="exploration-diagnostic.html#cb24-20"></a>  ) <span class="op">+</span></span>
<span id="cb24-21"><a href="exploration-diagnostic.html#cb24-21"></a><span class="st">  </span><span class="kw">scale_x_log10</span>(</span>
<span id="cb24-22"><a href="exploration-diagnostic.html#cb24-22"></a>    <span class="dt">name=</span><span class="st">&quot;Generation&quot;</span></span>
<span id="cb24-23"><a href="exploration-diagnostic.html#cb24-23"></a>  ) <span class="op">+</span></span>
<span id="cb24-24"><a href="exploration-diagnostic.html#cb24-24"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;Selection&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-25"><a href="exploration-diagnostic.html#cb24-25"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="st">&quot;Selection&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phenotypic_diversity_over_time_plot_shannon-1.png" width="672" /></p>
</div>
<div id="final-2" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Final</h3>
<div id="richness" class="section level4">
<h4><span class="header-section-number">2.4.3.1</span> Richness</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="exploration-diagnostic.html#cb25-1"></a><span class="co"># Determine which conditions are significantly diferrent from each other</span></span>
<span id="cb25-2"><a href="exploration-diagnostic.html#cb25-2"></a>stat.test &lt;-<span class="st"> </span>final_data <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="exploration-diagnostic.html#cb25-3"></a><span class="st">  </span><span class="kw">wilcox_test</span>(phen_num_taxa <span class="op">~</span><span class="st"> </span>selection_name) <span class="op">%&gt;%</span></span>
<span id="cb25-4"><a href="exploration-diagnostic.html#cb25-4"></a><span class="st">  </span><span class="kw">adjust_pvalue</span>(<span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb25-5"><a href="exploration-diagnostic.html#cb25-5"></a><span class="st">  </span><span class="kw">add_significance</span>() <span class="op">%&gt;%</span></span>
<span id="cb25-6"><a href="exploration-diagnostic.html#cb25-6"></a><span class="st">  </span><span class="kw">add_xy_position</span>(<span class="dt">x=</span><span class="st">&quot;selection_name&quot;</span>,<span class="dt">step.increase=</span><span class="dv">1</span>)</span>
<span id="cb25-7"><a href="exploration-diagnostic.html#cb25-7"></a>stat.test<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">mapply</span>(p_label,stat.test<span class="op">$</span>p.adj)</span>
<span id="cb25-8"><a href="exploration-diagnostic.html#cb25-8"></a></span>
<span id="cb25-9"><a href="exploration-diagnostic.html#cb25-9"></a>stat.test <span class="op">%&gt;%</span></span>
<span id="cb25-10"><a href="exploration-diagnostic.html#cb25-10"></a><span class="st">  </span><span class="kw">kbl</span>() <span class="op">%&gt;%</span></span>
<span id="cb25-11"><a href="exploration-diagnostic.html#cb25-11"></a><span class="st">  </span><span class="kw">kable_styling</span>(</span>
<span id="cb25-12"><a href="exploration-diagnostic.html#cb25-12"></a>    <span class="dt">bootstrap_options =</span> <span class="kw">c</span>(</span>
<span id="cb25-13"><a href="exploration-diagnostic.html#cb25-13"></a>      <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb25-14"><a href="exploration-diagnostic.html#cb25-14"></a>      <span class="st">&quot;hover&quot;</span>,</span>
<span id="cb25-15"><a href="exploration-diagnostic.html#cb25-15"></a>      <span class="st">&quot;condensed&quot;</span>,</span>
<span id="cb25-16"><a href="exploration-diagnostic.html#cb25-16"></a>      <span class="st">&quot;responsive&quot;</span></span>
<span id="cb25-17"><a href="exploration-diagnostic.html#cb25-17"></a>    )</span>
<span id="cb25-18"><a href="exploration-diagnostic.html#cb25-18"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb25-19"><a href="exploration-diagnostic.html#cb25-19"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width=</span><span class="st">&quot;600px&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:600px; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.y.
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:left;">
group2
</th>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p.adj
</th>
<th style="text-align:left;">
p.adj.signif
</th>
<th style="text-align:right;">
y.position
</th>
<th style="text-align:left;">
groups
</th>
<th style="text-align:right;">
xmin
</th>
<th style="text-align:right;">
xmax
</th>
<th style="text-align:left;">
label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2249.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
326
</td>
<td style="text-align:left;">
EcoEA , Fitness Sharing
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
2319.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
456
</td>
<td style="text-align:left;">
EcoEA , Lexicase
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2500.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
586
</td>
<td style="text-align:left;">
EcoEA , Random
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2378.5
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
716
</td>
<td style="text-align:left;">
EcoEA , Tournament
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
1428.0
</td>
<td style="text-align:right;">
6.80e-02
</td>
<td style="text-align:right;">
6.8e-01
</td>
<td style="text-align:left;">
ns
</td>
<td style="text-align:right;">
846
</td>
<td style="text-align:left;">
Fitness Sharing, Lexicase
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p = 0.68
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1973.0
</td>
<td style="text-align:right;">
6.00e-07
</td>
<td style="text-align:right;">
6.3e-06
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
976
</td>
<td style="text-align:left;">
Fitness Sharing, Random
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1585.0
</td>
<td style="text-align:right;">
2.10e-02
</td>
<td style="text-align:right;">
2.1e-01
</td>
<td style="text-align:left;">
ns
</td>
<td style="text-align:right;">
1106
</td>
<td style="text-align:left;">
Fitness Sharing, Tournament
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p = 0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2339.5
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
1236
</td>
<td style="text-align:left;">
Lexicase, Random
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1359.0
</td>
<td style="text-align:right;">
1.85e-01
</td>
<td style="text-align:right;">
1.0e+00
</td>
<td style="text-align:left;">
ns
</td>
<td style="text-align:right;">
1366
</td>
<td style="text-align:left;">
Lexicase , Tournament
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p = 1
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_num_taxa
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
797.0
</td>
<td style="text-align:right;">
2.00e-03
</td>
<td style="text-align:right;">
2.0e-02
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:right;">
1496
</td>
<td style="text-align:left;">
Random , Tournament
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p = 0.02
</td>
</tr>
</tbody>
</table>
</div></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="exploration-diagnostic.html#cb26-1"></a><span class="co"># Raincloud plot of final phenotypic diversity</span></span>
<span id="cb26-2"><a href="exploration-diagnostic.html#cb26-2"></a>final_phenotypic_fig &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb26-3"><a href="exploration-diagnostic.html#cb26-3"></a>    final_data,</span>
<span id="cb26-4"><a href="exploration-diagnostic.html#cb26-4"></a>    <span class="kw">aes</span>(</span>
<span id="cb26-5"><a href="exploration-diagnostic.html#cb26-5"></a>      <span class="dt">x=</span>selection_name,</span>
<span id="cb26-6"><a href="exploration-diagnostic.html#cb26-6"></a>      <span class="dt">y=</span>phen_num_taxa,</span>
<span id="cb26-7"><a href="exploration-diagnostic.html#cb26-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb26-8"><a href="exploration-diagnostic.html#cb26-8"></a>    )</span>
<span id="cb26-9"><a href="exploration-diagnostic.html#cb26-9"></a>  ) <span class="op">+</span></span>
<span id="cb26-10"><a href="exploration-diagnostic.html#cb26-10"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(</span>
<span id="cb26-11"><a href="exploration-diagnostic.html#cb26-11"></a>    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>),</span>
<span id="cb26-12"><a href="exploration-diagnostic.html#cb26-12"></a>    <span class="dt">alpha =</span> <span class="fl">.8</span>,</span>
<span id="cb26-13"><a href="exploration-diagnostic.html#cb26-13"></a>    <span class="dt">scale=</span><span class="st">&quot;width&quot;</span></span>
<span id="cb26-14"><a href="exploration-diagnostic.html#cb26-14"></a>  ) <span class="op">+</span></span>
<span id="cb26-15"><a href="exploration-diagnostic.html#cb26-15"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb26-16"><a href="exploration-diagnostic.html#cb26-16"></a>    <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>selection_name),</span>
<span id="cb26-17"><a href="exploration-diagnostic.html#cb26-17"></a>    <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.15</span>),</span>
<span id="cb26-18"><a href="exploration-diagnostic.html#cb26-18"></a>    <span class="dt">size =</span> <span class="fl">.5</span>,</span>
<span id="cb26-19"><a href="exploration-diagnostic.html#cb26-19"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb26-20"><a href="exploration-diagnostic.html#cb26-20"></a>  ) <span class="op">+</span></span>
<span id="cb26-21"><a href="exploration-diagnostic.html#cb26-21"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(</span>
<span id="cb26-22"><a href="exploration-diagnostic.html#cb26-22"></a>    <span class="dt">width =</span> <span class="fl">.1</span>,</span>
<span id="cb26-23"><a href="exploration-diagnostic.html#cb26-23"></a>    <span class="dt">outlier.shape =</span> <span class="ot">NA</span>,</span>
<span id="cb26-24"><a href="exploration-diagnostic.html#cb26-24"></a>    <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb26-25"><a href="exploration-diagnostic.html#cb26-25"></a>  ) <span class="op">+</span></span>
<span id="cb26-26"><a href="exploration-diagnostic.html#cb26-26"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb26-27"><a href="exploration-diagnostic.html#cb26-27"></a>    <span class="dt">name=</span><span class="st">&quot;Phenotypic Richness&quot;</span></span>
<span id="cb26-28"><a href="exploration-diagnostic.html#cb26-28"></a>  ) <span class="op">+</span></span>
<span id="cb26-29"><a href="exploration-diagnostic.html#cb26-29"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(</span>
<span id="cb26-30"><a href="exploration-diagnostic.html#cb26-30"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb26-31"><a href="exploration-diagnostic.html#cb26-31"></a>  ) <span class="op">+</span></span>
<span id="cb26-32"><a href="exploration-diagnostic.html#cb26-32"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(</span>
<span id="cb26-33"><a href="exploration-diagnostic.html#cb26-33"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb26-34"><a href="exploration-diagnostic.html#cb26-34"></a>  ) <span class="op">+</span></span>
<span id="cb26-35"><a href="exploration-diagnostic.html#cb26-35"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(</span>
<span id="cb26-36"><a href="exploration-diagnostic.html#cb26-36"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb26-37"><a href="exploration-diagnostic.html#cb26-37"></a>  ) <span class="op">+</span></span>
<span id="cb26-38"><a href="exploration-diagnostic.html#cb26-38"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb26-39"><a href="exploration-diagnostic.html#cb26-39"></a>final_phenotypic_fig</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/final_phenotypic_plot-1.png" width="672" /></p>
<p>Nothing particularly suprising here, but we should note that, based on the over time plot, this would look a lot different if we had selected a different time point.</p>
</div>
<div id="shannon-diversity" class="section level4">
<h4><span class="header-section-number">2.4.3.2</span> Shannon diversity</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="exploration-diagnostic.html#cb27-1"></a><span class="co"># Determine which conditions are significantly diferrent from each other</span></span>
<span id="cb27-2"><a href="exploration-diagnostic.html#cb27-2"></a>stat.test &lt;-<span class="st"> </span>final_data <span class="op">%&gt;%</span></span>
<span id="cb27-3"><a href="exploration-diagnostic.html#cb27-3"></a><span class="st">  </span><span class="kw">wilcox_test</span>(phen_diversity<span class="op">~</span><span class="st"> </span>selection_name) <span class="op">%&gt;%</span></span>
<span id="cb27-4"><a href="exploration-diagnostic.html#cb27-4"></a><span class="st">  </span><span class="kw">adjust_pvalue</span>(<span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb27-5"><a href="exploration-diagnostic.html#cb27-5"></a><span class="st">  </span><span class="kw">add_significance</span>() <span class="op">%&gt;%</span></span>
<span id="cb27-6"><a href="exploration-diagnostic.html#cb27-6"></a><span class="st">  </span><span class="kw">add_xy_position</span>(<span class="dt">x=</span><span class="st">&quot;selection_name&quot;</span>,<span class="dt">step.increase=</span><span class="dv">1</span>)</span>
<span id="cb27-7"><a href="exploration-diagnostic.html#cb27-7"></a>stat.test<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">mapply</span>(p_label,stat.test<span class="op">$</span>p.adj)</span>
<span id="cb27-8"><a href="exploration-diagnostic.html#cb27-8"></a></span>
<span id="cb27-9"><a href="exploration-diagnostic.html#cb27-9"></a>stat.test <span class="op">%&gt;%</span></span>
<span id="cb27-10"><a href="exploration-diagnostic.html#cb27-10"></a><span class="st">  </span><span class="kw">kbl</span>() <span class="op">%&gt;%</span></span>
<span id="cb27-11"><a href="exploration-diagnostic.html#cb27-11"></a><span class="st">  </span><span class="kw">kable_styling</span>(</span>
<span id="cb27-12"><a href="exploration-diagnostic.html#cb27-12"></a>    <span class="dt">bootstrap_options =</span> <span class="kw">c</span>(</span>
<span id="cb27-13"><a href="exploration-diagnostic.html#cb27-13"></a>      <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb27-14"><a href="exploration-diagnostic.html#cb27-14"></a>      <span class="st">&quot;hover&quot;</span>,</span>
<span id="cb27-15"><a href="exploration-diagnostic.html#cb27-15"></a>      <span class="st">&quot;condensed&quot;</span>,</span>
<span id="cb27-16"><a href="exploration-diagnostic.html#cb27-16"></a>      <span class="st">&quot;responsive&quot;</span></span>
<span id="cb27-17"><a href="exploration-diagnostic.html#cb27-17"></a>    )</span>
<span id="cb27-18"><a href="exploration-diagnostic.html#cb27-18"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb27-19"><a href="exploration-diagnostic.html#cb27-19"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width=</span><span class="st">&quot;600px&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:600px; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.y.
</th>
<th style="text-align:left;">
group1
</th>
<th style="text-align:left;">
group2
</th>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p.adj
</th>
<th style="text-align:left;">
p.adj.signif
</th>
<th style="text-align:right;">
y.position
</th>
<th style="text-align:left;">
groups
</th>
<th style="text-align:right;">
xmin
</th>
<th style="text-align:right;">
xmax
</th>
<th style="text-align:left;">
label
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2478.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
9.602
</td>
<td style="text-align:left;">
EcoEA , Fitness Sharing
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
1772.0
</td>
<td style="text-align:right;">
1.66e-05
</td>
<td style="text-align:right;">
1.66e-04
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:right;">
13.012
</td>
<td style="text-align:left;">
EcoEA , Lexicase
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p = 0.000166
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2089.5
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
1.00e-07
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
16.422
</td>
<td style="text-align:left;">
EcoEA , Random
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
EcoEA
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2496.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
19.832
</td>
<td style="text-align:left;">
EcoEA , Tournament
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
23.242
</td>
<td style="text-align:left;">
Fitness Sharing, Lexicase
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
26.652
</td>
<td style="text-align:left;">
Fitness Sharing, Random
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
Fitness Sharing
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1856.0
</td>
<td style="text-align:right;">
2.99e-05
</td>
<td style="text-align:right;">
2.99e-04
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:right;">
30.062
</td>
<td style="text-align:left;">
Fitness Sharing, Tournament
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p = 0.000299
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1714.0
</td>
<td style="text-align:right;">
1.01e-04
</td>
<td style="text-align:right;">
1.01e-03
</td>
<td style="text-align:left;">
**
</td>
<td style="text-align:right;">
33.472
</td>
<td style="text-align:left;">
Lexicase, Random
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
p = 0.00101
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
Lexicase
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2350.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
36.882
</td>
<td style="text-align:left;">
Lexicase , Tournament
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
<tr>
<td style="text-align:left;">
phen_diversity
</td>
<td style="text-align:left;">
Random
</td>
<td style="text-align:left;">
Tournament
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2500.0
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
****
</td>
<td style="text-align:right;">
40.292
</td>
<td style="text-align:left;">
Random , Tournament
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
p &lt; 1e-04
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="exploration-diagnostic.html#cb28-1"></a><span class="co"># Raincloud plot of final phenotypic diversity</span></span>
<span id="cb28-2"><a href="exploration-diagnostic.html#cb28-2"></a><span class="kw">ggplot</span>(</span>
<span id="cb28-3"><a href="exploration-diagnostic.html#cb28-3"></a>    final_data,</span>
<span id="cb28-4"><a href="exploration-diagnostic.html#cb28-4"></a>    <span class="kw">aes</span>(</span>
<span id="cb28-5"><a href="exploration-diagnostic.html#cb28-5"></a>      <span class="dt">x=</span>selection_name,</span>
<span id="cb28-6"><a href="exploration-diagnostic.html#cb28-6"></a>      <span class="dt">y=</span>phen_num_taxa,</span>
<span id="cb28-7"><a href="exploration-diagnostic.html#cb28-7"></a>      <span class="dt">fill=</span>selection_name</span>
<span id="cb28-8"><a href="exploration-diagnostic.html#cb28-8"></a>    )</span>
<span id="cb28-9"><a href="exploration-diagnostic.html#cb28-9"></a>  ) <span class="op">+</span></span>
<span id="cb28-10"><a href="exploration-diagnostic.html#cb28-10"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(</span>
<span id="cb28-11"><a href="exploration-diagnostic.html#cb28-11"></a>    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>),</span>
<span id="cb28-12"><a href="exploration-diagnostic.html#cb28-12"></a>    <span class="dt">alpha =</span> <span class="fl">.8</span>,</span>
<span id="cb28-13"><a href="exploration-diagnostic.html#cb28-13"></a>    <span class="dt">scale=</span><span class="st">&quot;width&quot;</span></span>
<span id="cb28-14"><a href="exploration-diagnostic.html#cb28-14"></a>  ) <span class="op">+</span></span>
<span id="cb28-15"><a href="exploration-diagnostic.html#cb28-15"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb28-16"><a href="exploration-diagnostic.html#cb28-16"></a>    <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>selection_name),</span>
<span id="cb28-17"><a href="exploration-diagnostic.html#cb28-17"></a>    <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.15</span>),</span>
<span id="cb28-18"><a href="exploration-diagnostic.html#cb28-18"></a>    <span class="dt">size =</span> <span class="fl">.5</span>,</span>
<span id="cb28-19"><a href="exploration-diagnostic.html#cb28-19"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb28-20"><a href="exploration-diagnostic.html#cb28-20"></a>  ) <span class="op">+</span></span>
<span id="cb28-21"><a href="exploration-diagnostic.html#cb28-21"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(</span>
<span id="cb28-22"><a href="exploration-diagnostic.html#cb28-22"></a>    <span class="dt">width =</span> <span class="fl">.1</span>,</span>
<span id="cb28-23"><a href="exploration-diagnostic.html#cb28-23"></a>    <span class="dt">outlier.shape =</span> <span class="ot">NA</span>,</span>
<span id="cb28-24"><a href="exploration-diagnostic.html#cb28-24"></a>    <span class="dt">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb28-25"><a href="exploration-diagnostic.html#cb28-25"></a>  ) <span class="op">+</span></span>
<span id="cb28-26"><a href="exploration-diagnostic.html#cb28-26"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb28-27"><a href="exploration-diagnostic.html#cb28-27"></a>    <span class="dt">name=</span><span class="st">&quot;Phenotypic Shannon Diversity&quot;</span></span>
<span id="cb28-28"><a href="exploration-diagnostic.html#cb28-28"></a>  ) <span class="op">+</span></span>
<span id="cb28-29"><a href="exploration-diagnostic.html#cb28-29"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(</span>
<span id="cb28-30"><a href="exploration-diagnostic.html#cb28-30"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb28-31"><a href="exploration-diagnostic.html#cb28-31"></a>  ) <span class="op">+</span></span>
<span id="cb28-32"><a href="exploration-diagnostic.html#cb28-32"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(</span>
<span id="cb28-33"><a href="exploration-diagnostic.html#cb28-33"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb28-34"><a href="exploration-diagnostic.html#cb28-34"></a>  ) <span class="op">+</span></span>
<span id="cb28-35"><a href="exploration-diagnostic.html#cb28-35"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(</span>
<span id="cb28-36"><a href="exploration-diagnostic.html#cb28-36"></a>    <span class="dt">name=</span><span class="st">&quot;Selection&quot;</span></span>
<span id="cb28-37"><a href="exploration-diagnostic.html#cb28-37"></a>  ) <span class="op">+</span></span>
<span id="cb28-38"><a href="exploration-diagnostic.html#cb28-38"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/final_phenotypic_plot_shannon-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="relationship-between-phenotypic-and-phylogenetic-diversity" class="section level2">
<h2><span class="header-section-number">2.5</span> Relationship between phenotypic and phylogenetic diversity</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="exploration-diagnostic.html#cb29-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb29-2"><a href="exploration-diagnostic.html#cb29-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">500000</span>),</span>
<span id="cb29-3"><a href="exploration-diagnostic.html#cb29-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb29-4"><a href="exploration-diagnostic.html#cb29-4"></a>        <span class="dt">y=</span>phen_num_taxa,</span>
<span id="cb29-5"><a href="exploration-diagnostic.html#cb29-5"></a>        <span class="dt">x=</span>mean_phenotype_pairwise_distance,</span>
<span id="cb29-6"><a href="exploration-diagnostic.html#cb29-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb29-7"><a href="exploration-diagnostic.html#cb29-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb29-8"><a href="exploration-diagnostic.html#cb29-8"></a>    )</span>
<span id="cb29-9"><a href="exploration-diagnostic.html#cb29-9"></a>  ) <span class="op">+</span></span>
<span id="cb29-10"><a href="exploration-diagnostic.html#cb29-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb29-11"><a href="exploration-diagnostic.html#cb29-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb29-12"><a href="exploration-diagnostic.html#cb29-12"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic richness&quot;</span></span>
<span id="cb29-13"><a href="exploration-diagnostic.html#cb29-13"></a>  ) <span class="op">+</span></span>
<span id="cb29-14"><a href="exploration-diagnostic.html#cb29-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb29-15"><a href="exploration-diagnostic.html#cb29-15"></a>        <span class="dt">name=</span><span class="st">&quot;Mean pairwise distance&quot;</span>,</span>
<span id="cb29-16"><a href="exploration-diagnostic.html#cb29-16"></a>        <span class="dt">breaks =</span> <span class="kw">breaks_extended</span>(<span class="dv">4</span>)</span>
<span id="cb29-17"><a href="exploration-diagnostic.html#cb29-17"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-18"><a href="exploration-diagnostic.html#cb29-18"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb29-19"><a href="exploration-diagnostic.html#cb29-19"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb29-20"><a href="exploration-diagnostic.html#cb29-20"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-21"><a href="exploration-diagnostic.html#cb29-21"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb29-22"><a href="exploration-diagnostic.html#cb29-22"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb29-23"><a href="exploration-diagnostic.html#cb29-23"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-24"><a href="exploration-diagnostic.html#cb29-24"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb29-25"><a href="exploration-diagnostic.html#cb29-25"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb29-26"><a href="exploration-diagnostic.html#cb29-26"></a>  ) <span class="op">+</span></span>
<span id="cb29-27"><a href="exploration-diagnostic.html#cb29-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phen_vs_phylo_richness_mpd-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="exploration-diagnostic.html#cb30-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb30-2"><a href="exploration-diagnostic.html#cb30-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">500000</span>),</span>
<span id="cb30-3"><a href="exploration-diagnostic.html#cb30-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb30-4"><a href="exploration-diagnostic.html#cb30-4"></a>        <span class="dt">y=</span>phen_num_taxa,</span>
<span id="cb30-5"><a href="exploration-diagnostic.html#cb30-5"></a>        <span class="dt">x=</span>mean_phenotype_evolutionary_distinctiveness,</span>
<span id="cb30-6"><a href="exploration-diagnostic.html#cb30-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb30-7"><a href="exploration-diagnostic.html#cb30-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb30-8"><a href="exploration-diagnostic.html#cb30-8"></a>    )</span>
<span id="cb30-9"><a href="exploration-diagnostic.html#cb30-9"></a>  ) <span class="op">+</span></span>
<span id="cb30-10"><a href="exploration-diagnostic.html#cb30-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb30-11"><a href="exploration-diagnostic.html#cb30-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb30-12"><a href="exploration-diagnostic.html#cb30-12"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic richness&quot;</span></span>
<span id="cb30-13"><a href="exploration-diagnostic.html#cb30-13"></a>  ) <span class="op">+</span></span>
<span id="cb30-14"><a href="exploration-diagnostic.html#cb30-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb30-15"><a href="exploration-diagnostic.html#cb30-15"></a>        <span class="dt">name=</span><span class="st">&quot;Mean evolutionary distinctiveness&quot;</span>,</span>
<span id="cb30-16"><a href="exploration-diagnostic.html#cb30-16"></a>        <span class="dt">breaks =</span> <span class="kw">breaks_extended</span>(<span class="dv">4</span>)</span>
<span id="cb30-17"><a href="exploration-diagnostic.html#cb30-17"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-18"><a href="exploration-diagnostic.html#cb30-18"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb30-19"><a href="exploration-diagnostic.html#cb30-19"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb30-20"><a href="exploration-diagnostic.html#cb30-20"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-21"><a href="exploration-diagnostic.html#cb30-21"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb30-22"><a href="exploration-diagnostic.html#cb30-22"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb30-23"><a href="exploration-diagnostic.html#cb30-23"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-24"><a href="exploration-diagnostic.html#cb30-24"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb30-25"><a href="exploration-diagnostic.html#cb30-25"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb30-26"><a href="exploration-diagnostic.html#cb30-26"></a>  ) <span class="op">+</span></span>
<span id="cb30-27"><a href="exploration-diagnostic.html#cb30-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phen_vs_phylo_richness_med-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="exploration-diagnostic.html#cb31-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb31-2"><a href="exploration-diagnostic.html#cb31-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">500000</span>),</span>
<span id="cb31-3"><a href="exploration-diagnostic.html#cb31-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb31-4"><a href="exploration-diagnostic.html#cb31-4"></a>        <span class="dt">y=</span>phen_diversity,</span>
<span id="cb31-5"><a href="exploration-diagnostic.html#cb31-5"></a>        <span class="dt">x=</span>mean_phenotype_pairwise_distance,</span>
<span id="cb31-6"><a href="exploration-diagnostic.html#cb31-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb31-7"><a href="exploration-diagnostic.html#cb31-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb31-8"><a href="exploration-diagnostic.html#cb31-8"></a>    )</span>
<span id="cb31-9"><a href="exploration-diagnostic.html#cb31-9"></a>  ) <span class="op">+</span></span>
<span id="cb31-10"><a href="exploration-diagnostic.html#cb31-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb31-11"><a href="exploration-diagnostic.html#cb31-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb31-12"><a href="exploration-diagnostic.html#cb31-12"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic shannon diversity&quot;</span></span>
<span id="cb31-13"><a href="exploration-diagnostic.html#cb31-13"></a>  ) <span class="op">+</span></span>
<span id="cb31-14"><a href="exploration-diagnostic.html#cb31-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb31-15"><a href="exploration-diagnostic.html#cb31-15"></a>        <span class="dt">name=</span><span class="st">&quot;Mean pairwise distance&quot;</span>,</span>
<span id="cb31-16"><a href="exploration-diagnostic.html#cb31-16"></a>        <span class="dt">breaks =</span> <span class="kw">breaks_extended</span>(<span class="dv">4</span>)</span>
<span id="cb31-17"><a href="exploration-diagnostic.html#cb31-17"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-18"><a href="exploration-diagnostic.html#cb31-18"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb31-19"><a href="exploration-diagnostic.html#cb31-19"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb31-20"><a href="exploration-diagnostic.html#cb31-20"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-21"><a href="exploration-diagnostic.html#cb31-21"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb31-22"><a href="exploration-diagnostic.html#cb31-22"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb31-23"><a href="exploration-diagnostic.html#cb31-23"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-24"><a href="exploration-diagnostic.html#cb31-24"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb31-25"><a href="exploration-diagnostic.html#cb31-25"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb31-26"><a href="exploration-diagnostic.html#cb31-26"></a>  ) <span class="op">+</span></span>
<span id="cb31-27"><a href="exploration-diagnostic.html#cb31-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phen_vs_phylo_shannon_mpd-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="exploration-diagnostic.html#cb32-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb32-2"><a href="exploration-diagnostic.html#cb32-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">500000</span>),</span>
<span id="cb32-3"><a href="exploration-diagnostic.html#cb32-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb32-4"><a href="exploration-diagnostic.html#cb32-4"></a>        <span class="dt">y=</span>phen_diversity,</span>
<span id="cb32-5"><a href="exploration-diagnostic.html#cb32-5"></a>        <span class="dt">x=</span>mean_phenotype_evolutionary_distinctiveness,</span>
<span id="cb32-6"><a href="exploration-diagnostic.html#cb32-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb32-7"><a href="exploration-diagnostic.html#cb32-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb32-8"><a href="exploration-diagnostic.html#cb32-8"></a>    )</span>
<span id="cb32-9"><a href="exploration-diagnostic.html#cb32-9"></a>  ) <span class="op">+</span></span>
<span id="cb32-10"><a href="exploration-diagnostic.html#cb32-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb32-11"><a href="exploration-diagnostic.html#cb32-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb32-12"><a href="exploration-diagnostic.html#cb32-12"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic shannon diversity&quot;</span></span>
<span id="cb32-13"><a href="exploration-diagnostic.html#cb32-13"></a>  ) <span class="op">+</span></span>
<span id="cb32-14"><a href="exploration-diagnostic.html#cb32-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb32-15"><a href="exploration-diagnostic.html#cb32-15"></a>        <span class="dt">name=</span><span class="st">&quot;Mean evolutionary distinctiveness&quot;</span>,</span>
<span id="cb32-16"><a href="exploration-diagnostic.html#cb32-16"></a>        <span class="dt">breaks =</span> <span class="kw">breaks_extended</span>(<span class="dv">4</span>)</span>
<span id="cb32-17"><a href="exploration-diagnostic.html#cb32-17"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-18"><a href="exploration-diagnostic.html#cb32-18"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb32-19"><a href="exploration-diagnostic.html#cb32-19"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb32-20"><a href="exploration-diagnostic.html#cb32-20"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-21"><a href="exploration-diagnostic.html#cb32-21"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb32-22"><a href="exploration-diagnostic.html#cb32-22"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb32-23"><a href="exploration-diagnostic.html#cb32-23"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-24"><a href="exploration-diagnostic.html#cb32-24"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb32-25"><a href="exploration-diagnostic.html#cb32-25"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb32-26"><a href="exploration-diagnostic.html#cb32-26"></a>  ) <span class="op">+</span></span>
<span id="cb32-27"><a href="exploration-diagnostic.html#cb32-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phen_vs_phylo_shannon_med-1.png" width="672" /></p>
</div>
<div id="relationship-between-diversity-and-success" class="section level2">
<h2><span class="header-section-number">2.6</span> Relationship between diversity and success</h2>
<div id="earlier-in-run" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Earlier in run</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="exploration-diagnostic.html#cb33-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb33-2"><a href="exploration-diagnostic.html#cb33-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">25000</span>),</span>
<span id="cb33-3"><a href="exploration-diagnostic.html#cb33-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb33-4"><a href="exploration-diagnostic.html#cb33-4"></a>        <span class="dt">y=</span>elite_trait_avg,</span>
<span id="cb33-5"><a href="exploration-diagnostic.html#cb33-5"></a>        <span class="dt">x=</span>mean_phenotype_pairwise_distance,</span>
<span id="cb33-6"><a href="exploration-diagnostic.html#cb33-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb33-7"><a href="exploration-diagnostic.html#cb33-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb33-8"><a href="exploration-diagnostic.html#cb33-8"></a>    )</span>
<span id="cb33-9"><a href="exploration-diagnostic.html#cb33-9"></a>  ) <span class="op">+</span></span>
<span id="cb33-10"><a href="exploration-diagnostic.html#cb33-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb33-11"><a href="exploration-diagnostic.html#cb33-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb33-12"><a href="exploration-diagnostic.html#cb33-12"></a>        <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span></span>
<span id="cb33-13"><a href="exploration-diagnostic.html#cb33-13"></a>  ) <span class="op">+</span></span>
<span id="cb33-14"><a href="exploration-diagnostic.html#cb33-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb33-15"><a href="exploration-diagnostic.html#cb33-15"></a>        <span class="dt">name=</span><span class="st">&quot;Mean pairwise distance&quot;</span></span>
<span id="cb33-16"><a href="exploration-diagnostic.html#cb33-16"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-17"><a href="exploration-diagnostic.html#cb33-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb33-18"><a href="exploration-diagnostic.html#cb33-18"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb33-19"><a href="exploration-diagnostic.html#cb33-19"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-20"><a href="exploration-diagnostic.html#cb33-20"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb33-21"><a href="exploration-diagnostic.html#cb33-21"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb33-22"><a href="exploration-diagnostic.html#cb33-22"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-23"><a href="exploration-diagnostic.html#cb33-23"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb33-24"><a href="exploration-diagnostic.html#cb33-24"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb33-25"><a href="exploration-diagnostic.html#cb33-25"></a>  ) <span class="op">+</span></span>
<span id="cb33-26"><a href="exploration-diagnostic.html#cb33-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phylogeny_vs_performance_very_early-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="exploration-diagnostic.html#cb34-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb34-2"><a href="exploration-diagnostic.html#cb34-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">25000</span>),</span>
<span id="cb34-3"><a href="exploration-diagnostic.html#cb34-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb34-4"><a href="exploration-diagnostic.html#cb34-4"></a>        <span class="dt">y=</span>elite_trait_avg,</span>
<span id="cb34-5"><a href="exploration-diagnostic.html#cb34-5"></a>        <span class="dt">x=</span>phen_num_taxa,</span>
<span id="cb34-6"><a href="exploration-diagnostic.html#cb34-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb34-7"><a href="exploration-diagnostic.html#cb34-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb34-8"><a href="exploration-diagnostic.html#cb34-8"></a>    )</span>
<span id="cb34-9"><a href="exploration-diagnostic.html#cb34-9"></a>  ) <span class="op">+</span></span>
<span id="cb34-10"><a href="exploration-diagnostic.html#cb34-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb34-11"><a href="exploration-diagnostic.html#cb34-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb34-12"><a href="exploration-diagnostic.html#cb34-12"></a>        <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span></span>
<span id="cb34-13"><a href="exploration-diagnostic.html#cb34-13"></a>  ) <span class="op">+</span></span>
<span id="cb34-14"><a href="exploration-diagnostic.html#cb34-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb34-15"><a href="exploration-diagnostic.html#cb34-15"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic richness&quot;</span></span>
<span id="cb34-16"><a href="exploration-diagnostic.html#cb34-16"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-17"><a href="exploration-diagnostic.html#cb34-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb34-18"><a href="exploration-diagnostic.html#cb34-18"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb34-19"><a href="exploration-diagnostic.html#cb34-19"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-20"><a href="exploration-diagnostic.html#cb34-20"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb34-21"><a href="exploration-diagnostic.html#cb34-21"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb34-22"><a href="exploration-diagnostic.html#cb34-22"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-23"><a href="exploration-diagnostic.html#cb34-23"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb34-24"><a href="exploration-diagnostic.html#cb34-24"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb34-25"><a href="exploration-diagnostic.html#cb34-25"></a>  ) <span class="op">+</span></span>
<span id="cb34-26"><a href="exploration-diagnostic.html#cb34-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/richness_vs_performance_very_early-1.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="exploration-diagnostic.html#cb35-1"></a>phylogney_vs_performance &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb35-2"><a href="exploration-diagnostic.html#cb35-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">50000</span>),</span>
<span id="cb35-3"><a href="exploration-diagnostic.html#cb35-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb35-4"><a href="exploration-diagnostic.html#cb35-4"></a>        <span class="dt">y=</span>elite_trait_avg,</span>
<span id="cb35-5"><a href="exploration-diagnostic.html#cb35-5"></a>        <span class="dt">x=</span>mean_phenotype_pairwise_distance,</span>
<span id="cb35-6"><a href="exploration-diagnostic.html#cb35-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb35-7"><a href="exploration-diagnostic.html#cb35-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb35-8"><a href="exploration-diagnostic.html#cb35-8"></a>    )</span>
<span id="cb35-9"><a href="exploration-diagnostic.html#cb35-9"></a>  ) <span class="op">+</span></span>
<span id="cb35-10"><a href="exploration-diagnostic.html#cb35-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb35-11"><a href="exploration-diagnostic.html#cb35-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb35-12"><a href="exploration-diagnostic.html#cb35-12"></a>        <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span></span>
<span id="cb35-13"><a href="exploration-diagnostic.html#cb35-13"></a>  ) <span class="op">+</span></span>
<span id="cb35-14"><a href="exploration-diagnostic.html#cb35-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb35-15"><a href="exploration-diagnostic.html#cb35-15"></a>        <span class="dt">name=</span><span class="st">&quot;Mean pairwise distance&quot;</span></span>
<span id="cb35-16"><a href="exploration-diagnostic.html#cb35-16"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-17"><a href="exploration-diagnostic.html#cb35-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb35-18"><a href="exploration-diagnostic.html#cb35-18"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb35-19"><a href="exploration-diagnostic.html#cb35-19"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-20"><a href="exploration-diagnostic.html#cb35-20"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb35-21"><a href="exploration-diagnostic.html#cb35-21"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb35-22"><a href="exploration-diagnostic.html#cb35-22"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-23"><a href="exploration-diagnostic.html#cb35-23"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb35-24"><a href="exploration-diagnostic.html#cb35-24"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb35-25"><a href="exploration-diagnostic.html#cb35-25"></a>  ) <span class="op">+</span></span>
<span id="cb35-26"><a href="exploration-diagnostic.html#cb35-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb35-27"><a href="exploration-diagnostic.html#cb35-27"></a>  </span>
<span id="cb35-28"><a href="exploration-diagnostic.html#cb35-28"></a>phylogney_vs_performance</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phylogeny_vs_performance_early-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="exploration-diagnostic.html#cb36-1"></a>richness_vs_performance &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb36-2"><a href="exploration-diagnostic.html#cb36-2"></a>    data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(gen<span class="op">==</span><span class="dv">50000</span>),</span>
<span id="cb36-3"><a href="exploration-diagnostic.html#cb36-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb36-4"><a href="exploration-diagnostic.html#cb36-4"></a>        <span class="dt">y=</span>elite_trait_avg,</span>
<span id="cb36-5"><a href="exploration-diagnostic.html#cb36-5"></a>        <span class="dt">x=</span>phen_num_taxa,</span>
<span id="cb36-6"><a href="exploration-diagnostic.html#cb36-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb36-7"><a href="exploration-diagnostic.html#cb36-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb36-8"><a href="exploration-diagnostic.html#cb36-8"></a>    )</span>
<span id="cb36-9"><a href="exploration-diagnostic.html#cb36-9"></a>  ) <span class="op">+</span></span>
<span id="cb36-10"><a href="exploration-diagnostic.html#cb36-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb36-11"><a href="exploration-diagnostic.html#cb36-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb36-12"><a href="exploration-diagnostic.html#cb36-12"></a>        <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span></span>
<span id="cb36-13"><a href="exploration-diagnostic.html#cb36-13"></a>  ) <span class="op">+</span></span>
<span id="cb36-14"><a href="exploration-diagnostic.html#cb36-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb36-15"><a href="exploration-diagnostic.html#cb36-15"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic richness&quot;</span></span>
<span id="cb36-16"><a href="exploration-diagnostic.html#cb36-16"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-17"><a href="exploration-diagnostic.html#cb36-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb36-18"><a href="exploration-diagnostic.html#cb36-18"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb36-19"><a href="exploration-diagnostic.html#cb36-19"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-20"><a href="exploration-diagnostic.html#cb36-20"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb36-21"><a href="exploration-diagnostic.html#cb36-21"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb36-22"><a href="exploration-diagnostic.html#cb36-22"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-23"><a href="exploration-diagnostic.html#cb36-23"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb36-24"><a href="exploration-diagnostic.html#cb36-24"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb36-25"><a href="exploration-diagnostic.html#cb36-25"></a>  ) <span class="op">+</span></span>
<span id="cb36-26"><a href="exploration-diagnostic.html#cb36-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb36-27"><a href="exploration-diagnostic.html#cb36-27"></a>  </span>
<span id="cb36-28"><a href="exploration-diagnostic.html#cb36-28"></a>richness_vs_performance</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/richness_vs_performance_early-1.png" width="672" /></p>
</div>
<div id="end-of-run" class="section level3">
<h3><span class="header-section-number">2.6.2</span> End of run</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="exploration-diagnostic.html#cb37-1"></a>final_phylogney_vs_performance &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb37-2"><a href="exploration-diagnostic.html#cb37-2"></a>    final_data,</span>
<span id="cb37-3"><a href="exploration-diagnostic.html#cb37-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb37-4"><a href="exploration-diagnostic.html#cb37-4"></a>        <span class="dt">y=</span>elite_trait_avg,</span>
<span id="cb37-5"><a href="exploration-diagnostic.html#cb37-5"></a>        <span class="dt">x=</span>mean_phenotype_pairwise_distance,</span>
<span id="cb37-6"><a href="exploration-diagnostic.html#cb37-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb37-7"><a href="exploration-diagnostic.html#cb37-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb37-8"><a href="exploration-diagnostic.html#cb37-8"></a>    )</span>
<span id="cb37-9"><a href="exploration-diagnostic.html#cb37-9"></a>  ) <span class="op">+</span></span>
<span id="cb37-10"><a href="exploration-diagnostic.html#cb37-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb37-11"><a href="exploration-diagnostic.html#cb37-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb37-12"><a href="exploration-diagnostic.html#cb37-12"></a>        <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span></span>
<span id="cb37-13"><a href="exploration-diagnostic.html#cb37-13"></a>  ) <span class="op">+</span></span>
<span id="cb37-14"><a href="exploration-diagnostic.html#cb37-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb37-15"><a href="exploration-diagnostic.html#cb37-15"></a>        <span class="dt">name=</span><span class="st">&quot;Mean pairwise distance&quot;</span></span>
<span id="cb37-16"><a href="exploration-diagnostic.html#cb37-16"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-17"><a href="exploration-diagnostic.html#cb37-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb37-18"><a href="exploration-diagnostic.html#cb37-18"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb37-19"><a href="exploration-diagnostic.html#cb37-19"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-20"><a href="exploration-diagnostic.html#cb37-20"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb37-21"><a href="exploration-diagnostic.html#cb37-21"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb37-22"><a href="exploration-diagnostic.html#cb37-22"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-23"><a href="exploration-diagnostic.html#cb37-23"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb37-24"><a href="exploration-diagnostic.html#cb37-24"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb37-25"><a href="exploration-diagnostic.html#cb37-25"></a>  ) <span class="op">+</span></span>
<span id="cb37-26"><a href="exploration-diagnostic.html#cb37-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb37-27"><a href="exploration-diagnostic.html#cb37-27"></a>  </span>
<span id="cb37-28"><a href="exploration-diagnostic.html#cb37-28"></a>final_phylogney_vs_performance</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/phylogeny_vs_performance-1.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="exploration-diagnostic.html#cb38-1"></a>final_richness_vs_performance &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb38-2"><a href="exploration-diagnostic.html#cb38-2"></a>    final_data,</span>
<span id="cb38-3"><a href="exploration-diagnostic.html#cb38-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb38-4"><a href="exploration-diagnostic.html#cb38-4"></a>        <span class="dt">y=</span>elite_trait_avg,</span>
<span id="cb38-5"><a href="exploration-diagnostic.html#cb38-5"></a>        <span class="dt">x=</span>phen_num_taxa,</span>
<span id="cb38-6"><a href="exploration-diagnostic.html#cb38-6"></a>        <span class="dt">color=</span>selection_name,</span>
<span id="cb38-7"><a href="exploration-diagnostic.html#cb38-7"></a>        <span class="dt">fill=</span>selection_name</span>
<span id="cb38-8"><a href="exploration-diagnostic.html#cb38-8"></a>    )</span>
<span id="cb38-9"><a href="exploration-diagnostic.html#cb38-9"></a>  ) <span class="op">+</span></span>
<span id="cb38-10"><a href="exploration-diagnostic.html#cb38-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb38-11"><a href="exploration-diagnostic.html#cb38-11"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(</span>
<span id="cb38-12"><a href="exploration-diagnostic.html#cb38-12"></a>        <span class="dt">name=</span><span class="st">&quot;Average trait performance&quot;</span></span>
<span id="cb38-13"><a href="exploration-diagnostic.html#cb38-13"></a>  ) <span class="op">+</span></span>
<span id="cb38-14"><a href="exploration-diagnostic.html#cb38-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb38-15"><a href="exploration-diagnostic.html#cb38-15"></a>        <span class="dt">name=</span><span class="st">&quot;Phenotypic richness&quot;</span></span>
<span id="cb38-16"><a href="exploration-diagnostic.html#cb38-16"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-17"><a href="exploration-diagnostic.html#cb38-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(</span>
<span id="cb38-18"><a href="exploration-diagnostic.html#cb38-18"></a>      <span class="op">~</span>selection_name, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span></span>
<span id="cb38-19"><a href="exploration-diagnostic.html#cb38-19"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-20"><a href="exploration-diagnostic.html#cb38-20"></a><span class="st">  </span><span class="kw">stat_smooth</span>(</span>
<span id="cb38-21"><a href="exploration-diagnostic.html#cb38-21"></a>    <span class="dt">method=</span><span class="st">&quot;lm&quot;</span></span>
<span id="cb38-22"><a href="exploration-diagnostic.html#cb38-22"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-23"><a href="exploration-diagnostic.html#cb38-23"></a><span class="st">  </span><span class="kw">stat_cor</span>(</span>
<span id="cb38-24"><a href="exploration-diagnostic.html#cb38-24"></a>    <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>, <span class="dt">cor.coef.name =</span> <span class="st">&quot;rho&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span></span>
<span id="cb38-25"><a href="exploration-diagnostic.html#cb38-25"></a>  ) <span class="op">+</span></span>
<span id="cb38-26"><a href="exploration-diagnostic.html#cb38-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb38-27"><a href="exploration-diagnostic.html#cb38-27"></a>  </span>
<span id="cb38-28"><a href="exploration-diagnostic.html#cb38-28"></a>final_richness_vs_performance</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/richness_vs_performance-1.png" width="672" /></p>
</div>
</div>
<div id="causality-analysis" class="section level2">
<h2><span class="header-section-number">2.7</span> Causality analysis</h2>
<div id="transfer-entropy-from-diversity-to-fitness" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Transfer entropy from diversity to fitness</h3>
<div id="max-pairwise-distance-vs.-phenotypic-richness" class="section level4">
<h4><span class="header-section-number">2.7.1.1</span> Max pairwise distance vs. phenotypic richness</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="exploration-diagnostic.html#cb39-1"></a><span class="co"># Calculate transfer entropy for max pairwise distance</span></span>
<span id="cb39-2"><a href="exploration-diagnostic.html#cb39-2"></a><span class="co"># Time points are 10 generations, so calculating lag 1 gives us lag 10</span></span>
<span id="cb39-3"><a href="exploration-diagnostic.html#cb39-3"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb39-4"><a href="exploration-diagnostic.html#cb39-4"></a><span class="kw">summarise</span>(</span>
<span id="cb39-5"><a href="exploration-diagnostic.html#cb39-5"></a>  <span class="dt">fit_phylo_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10</span></span>
<span id="cb39-6"><a href="exploration-diagnostic.html#cb39-6"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">1</span>)), </span>
<span id="cb39-7"><a href="exploration-diagnostic.html#cb39-7"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb39-8"><a href="exploration-diagnostic.html#cb39-8"></a>  <span class="dt">fit_phylo_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100</span></span>
<span id="cb39-9"><a href="exploration-diagnostic.html#cb39-9"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">10</span>)), </span>
<span id="cb39-10"><a href="exploration-diagnostic.html#cb39-10"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb39-11"><a href="exploration-diagnostic.html#cb39-11"></a>  <span class="dt">fit_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 1000</span></span>
<span id="cb39-12"><a href="exploration-diagnostic.html#cb39-12"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">100</span>)), </span>
<span id="cb39-13"><a href="exploration-diagnostic.html#cb39-13"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb39-14"><a href="exploration-diagnostic.html#cb39-14"></a>  <span class="dt">fit_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10000</span></span>
<span id="cb39-15"><a href="exploration-diagnostic.html#cb39-15"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">1000</span>)), </span>
<span id="cb39-16"><a href="exploration-diagnostic.html#cb39-16"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb39-17"><a href="exploration-diagnostic.html#cb39-17"></a>  <span class="dt">fit_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100000</span></span>
<span id="cb39-18"><a href="exploration-diagnostic.html#cb39-18"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">10000</span>)), </span>
<span id="cb39-19"><a href="exploration-diagnostic.html#cb39-19"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>))),  </span>
<span id="cb39-20"><a href="exploration-diagnostic.html#cb39-20"></a>  <span class="dt">fit_fit_10000 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb39-21"><a href="exploration-diagnostic.html#cb39-21"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>)), </span>
<span id="cb39-22"><a href="exploration-diagnostic.html#cb39-22"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">1000</span>))),</span>
<span id="cb39-23"><a href="exploration-diagnostic.html#cb39-23"></a>  <span class="dt">fit_fit_100000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb39-24"><a href="exploration-diagnostic.html#cb39-24"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)), </span>
<span id="cb39-25"><a href="exploration-diagnostic.html#cb39-25"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">10000</span>))),  </span>
<span id="cb39-26"><a href="exploration-diagnostic.html#cb39-26"></a>  <span class="dt">fit_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE pheno -&gt; fit, lag 10</span></span>
<span id="cb39-27"><a href="exploration-diagnostic.html#cb39-27"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>)), </span>
<span id="cb39-28"><a href="exploration-diagnostic.html#cb39-28"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb39-29"><a href="exploration-diagnostic.html#cb39-29"></a>  <span class="dt">fit_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100 </span></span>
<span id="cb39-30"><a href="exploration-diagnostic.html#cb39-30"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>)), </span>
<span id="cb39-31"><a href="exploration-diagnostic.html#cb39-31"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb39-32"><a href="exploration-diagnostic.html#cb39-32"></a>  <span class="dt">fit_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 1000</span></span>
<span id="cb39-33"><a href="exploration-diagnostic.html#cb39-33"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>)), </span>
<span id="cb39-34"><a href="exploration-diagnostic.html#cb39-34"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb39-35"><a href="exploration-diagnostic.html#cb39-35"></a>  <span class="dt">fit_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 10000</span></span>
<span id="cb39-36"><a href="exploration-diagnostic.html#cb39-36"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>)), </span>
<span id="cb39-37"><a href="exploration-diagnostic.html#cb39-37"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb39-38"><a href="exploration-diagnostic.html#cb39-38"></a>  <span class="dt">fit_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100000</span></span>
<span id="cb39-39"><a href="exploration-diagnostic.html#cb39-39"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>)), </span>
<span id="cb39-40"><a href="exploration-diagnostic.html#cb39-40"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)))</span>
<span id="cb39-41"><a href="exploration-diagnostic.html#cb39-41"></a>)</span>
<span id="cb39-42"><a href="exploration-diagnostic.html#cb39-42"></a></span>
<span id="cb39-43"><a href="exploration-diagnostic.html#cb39-43"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb39-44"><a href="exploration-diagnostic.html#cb39-44"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;o_10&quot;</span>))</span>
<span id="cb39-45"><a href="exploration-diagnostic.html#cb39-45"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb39-46"><a href="exploration-diagnostic.html#cb39-46"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb39-47"><a href="exploration-diagnostic.html#cb39-47"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb39-48"><a href="exploration-diagnostic.html#cb39-48"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo&quot;</span>) <span class="op">~</span><span class="st"> &quot;Phylogenetic&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Phenotypic&quot;</span>)</span>
<span id="cb39-49"><a href="exploration-diagnostic.html#cb39-49"></a></span>
<span id="cb39-50"><a href="exploration-diagnostic.html#cb39-50"></a><span class="co"># Plot transfer entropy</span></span>
<span id="cb39-51"><a href="exploration-diagnostic.html#cb39-51"></a><span class="kw">ggplot</span>(</span>
<span id="cb39-52"><a href="exploration-diagnostic.html#cb39-52"></a>  res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(name, <span class="st">&quot;fit_ph*&quot;</span>)), </span>
<span id="cb39-53"><a href="exploration-diagnostic.html#cb39-53"></a>  <span class="kw">aes</span>(</span>
<span id="cb39-54"><a href="exploration-diagnostic.html#cb39-54"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb39-55"><a href="exploration-diagnostic.html#cb39-55"></a>    <span class="dt">y=</span>value, </span>
<span id="cb39-56"><a href="exploration-diagnostic.html#cb39-56"></a>    <span class="dt">color=</span>Type</span>
<span id="cb39-57"><a href="exploration-diagnostic.html#cb39-57"></a>    )</span>
<span id="cb39-58"><a href="exploration-diagnostic.html#cb39-58"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-59"><a href="exploration-diagnostic.html#cb39-59"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-60"><a href="exploration-diagnostic.html#cb39-60"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-61"><a href="exploration-diagnostic.html#cb39-61"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-62"><a href="exploration-diagnostic.html#cb39-62"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-63"><a href="exploration-diagnostic.html#cb39-63"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb39-64"><a href="exploration-diagnostic.html#cb39-64"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-65"><a href="exploration-diagnostic.html#cb39-65"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory-1.png" width="672" /></p>
</div>
<div id="mean-pairwise-distance-vs.-phenotypic-richness" class="section level4">
<h4><span class="header-section-number">2.7.1.2</span> Mean pairwise distance vs. phenotypic richness</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="exploration-diagnostic.html#cb40-1"></a><span class="co"># Calculate transfer entropy for mean pairwise distance</span></span>
<span id="cb40-2"><a href="exploration-diagnostic.html#cb40-2"></a><span class="co"># Time points are 10 generations, so calculating lag 1 gives us lag 10</span></span>
<span id="cb40-3"><a href="exploration-diagnostic.html#cb40-3"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb40-4"><a href="exploration-diagnostic.html#cb40-4"></a><span class="kw">summarise</span>(</span>
<span id="cb40-5"><a href="exploration-diagnostic.html#cb40-5"></a>  <span class="dt">fit_phylo_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10</span></span>
<span id="cb40-6"><a href="exploration-diagnostic.html#cb40-6"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1</span>)), </span>
<span id="cb40-7"><a href="exploration-diagnostic.html#cb40-7"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb40-8"><a href="exploration-diagnostic.html#cb40-8"></a>  <span class="dt">fit_phylo_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100</span></span>
<span id="cb40-9"><a href="exploration-diagnostic.html#cb40-9"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10</span>)), </span>
<span id="cb40-10"><a href="exploration-diagnostic.html#cb40-10"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb40-11"><a href="exploration-diagnostic.html#cb40-11"></a>  <span class="dt">fit_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 1000</span></span>
<span id="cb40-12"><a href="exploration-diagnostic.html#cb40-12"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">100</span>)), </span>
<span id="cb40-13"><a href="exploration-diagnostic.html#cb40-13"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb40-14"><a href="exploration-diagnostic.html#cb40-14"></a>  <span class="dt">fit_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10000</span></span>
<span id="cb40-15"><a href="exploration-diagnostic.html#cb40-15"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>)), </span>
<span id="cb40-16"><a href="exploration-diagnostic.html#cb40-16"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb40-17"><a href="exploration-diagnostic.html#cb40-17"></a>  <span class="dt">fit_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100000</span></span>
<span id="cb40-18"><a href="exploration-diagnostic.html#cb40-18"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>)), </span>
<span id="cb40-19"><a href="exploration-diagnostic.html#cb40-19"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>))),  </span>
<span id="cb40-20"><a href="exploration-diagnostic.html#cb40-20"></a>  <span class="dt">fit_fit_10000 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb40-21"><a href="exploration-diagnostic.html#cb40-21"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>)), </span>
<span id="cb40-22"><a href="exploration-diagnostic.html#cb40-22"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>))),</span>
<span id="cb40-23"><a href="exploration-diagnostic.html#cb40-23"></a>  <span class="dt">fit_fit_100000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb40-24"><a href="exploration-diagnostic.html#cb40-24"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)), </span>
<span id="cb40-25"><a href="exploration-diagnostic.html#cb40-25"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>))),  </span>
<span id="cb40-26"><a href="exploration-diagnostic.html#cb40-26"></a>  <span class="dt">fit_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE pheno -&gt; fit, lag 10</span></span>
<span id="cb40-27"><a href="exploration-diagnostic.html#cb40-27"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>)), </span>
<span id="cb40-28"><a href="exploration-diagnostic.html#cb40-28"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb40-29"><a href="exploration-diagnostic.html#cb40-29"></a>  <span class="dt">fit_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100 </span></span>
<span id="cb40-30"><a href="exploration-diagnostic.html#cb40-30"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>)), </span>
<span id="cb40-31"><a href="exploration-diagnostic.html#cb40-31"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb40-32"><a href="exploration-diagnostic.html#cb40-32"></a>  <span class="dt">fit_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 1000</span></span>
<span id="cb40-33"><a href="exploration-diagnostic.html#cb40-33"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>)), </span>
<span id="cb40-34"><a href="exploration-diagnostic.html#cb40-34"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb40-35"><a href="exploration-diagnostic.html#cb40-35"></a>  <span class="dt">fit_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 10000</span></span>
<span id="cb40-36"><a href="exploration-diagnostic.html#cb40-36"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>)), </span>
<span id="cb40-37"><a href="exploration-diagnostic.html#cb40-37"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb40-38"><a href="exploration-diagnostic.html#cb40-38"></a>  <span class="dt">fit_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100000</span></span>
<span id="cb40-39"><a href="exploration-diagnostic.html#cb40-39"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>)), </span>
<span id="cb40-40"><a href="exploration-diagnostic.html#cb40-40"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)))</span>
<span id="cb40-41"><a href="exploration-diagnostic.html#cb40-41"></a>)</span>
<span id="cb40-42"><a href="exploration-diagnostic.html#cb40-42"></a></span>
<span id="cb40-43"><a href="exploration-diagnostic.html#cb40-43"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb40-44"><a href="exploration-diagnostic.html#cb40-44"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;o_10&quot;</span>))</span>
<span id="cb40-45"><a href="exploration-diagnostic.html#cb40-45"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb40-46"><a href="exploration-diagnostic.html#cb40-46"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb40-47"><a href="exploration-diagnostic.html#cb40-47"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb40-48"><a href="exploration-diagnostic.html#cb40-48"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo&quot;</span>) <span class="op">~</span><span class="st"> &quot;Phylogenetic&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Phenotypic&quot;</span>)</span>
<span id="cb40-49"><a href="exploration-diagnostic.html#cb40-49"></a></span>
<span id="cb40-50"><a href="exploration-diagnostic.html#cb40-50"></a><span class="co"># Plot transfer entropy</span></span>
<span id="cb40-51"><a href="exploration-diagnostic.html#cb40-51"></a><span class="kw">ggplot</span>(</span>
<span id="cb40-52"><a href="exploration-diagnostic.html#cb40-52"></a>  res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(name, <span class="st">&quot;fit_ph*&quot;</span>)), </span>
<span id="cb40-53"><a href="exploration-diagnostic.html#cb40-53"></a>  <span class="kw">aes</span>(</span>
<span id="cb40-54"><a href="exploration-diagnostic.html#cb40-54"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb40-55"><a href="exploration-diagnostic.html#cb40-55"></a>    <span class="dt">y=</span>value, </span>
<span id="cb40-56"><a href="exploration-diagnostic.html#cb40-56"></a>    <span class="dt">color=</span>Type</span>
<span id="cb40-57"><a href="exploration-diagnostic.html#cb40-57"></a>    )</span>
<span id="cb40-58"><a href="exploration-diagnostic.html#cb40-58"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-59"><a href="exploration-diagnostic.html#cb40-59"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-60"><a href="exploration-diagnostic.html#cb40-60"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-61"><a href="exploration-diagnostic.html#cb40-61"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-62"><a href="exploration-diagnostic.html#cb40-62"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-63"><a href="exploration-diagnostic.html#cb40-63"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb40-64"><a href="exploration-diagnostic.html#cb40-64"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-65"><a href="exploration-diagnostic.html#cb40-65"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_mpd-1.png" width="672" /></p>
</div>
<div id="mean-pairwise-distance-vs.-shannon-entropy" class="section level4">
<h4><span class="header-section-number">2.7.1.3</span> Mean pairwise distance vs. shannon entropy</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="exploration-diagnostic.html#cb41-1"></a><span class="co"># Calculate transfer entropy for mean pairwise distance</span></span>
<span id="cb41-2"><a href="exploration-diagnostic.html#cb41-2"></a><span class="co"># Time points are 10 generations, so calculating lag 1 gives us lag 10</span></span>
<span id="cb41-3"><a href="exploration-diagnostic.html#cb41-3"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb41-4"><a href="exploration-diagnostic.html#cb41-4"></a><span class="kw">summarise</span>(</span>
<span id="cb41-5"><a href="exploration-diagnostic.html#cb41-5"></a>  <span class="dt">fit_phylo_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10</span></span>
<span id="cb41-6"><a href="exploration-diagnostic.html#cb41-6"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1</span>)), </span>
<span id="cb41-7"><a href="exploration-diagnostic.html#cb41-7"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb41-8"><a href="exploration-diagnostic.html#cb41-8"></a>  <span class="dt">fit_phylo_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100</span></span>
<span id="cb41-9"><a href="exploration-diagnostic.html#cb41-9"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10</span>)), </span>
<span id="cb41-10"><a href="exploration-diagnostic.html#cb41-10"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb41-11"><a href="exploration-diagnostic.html#cb41-11"></a>  <span class="dt">fit_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 1000</span></span>
<span id="cb41-12"><a href="exploration-diagnostic.html#cb41-12"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">100</span>)), </span>
<span id="cb41-13"><a href="exploration-diagnostic.html#cb41-13"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb41-14"><a href="exploration-diagnostic.html#cb41-14"></a>  <span class="dt">fit_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10000</span></span>
<span id="cb41-15"><a href="exploration-diagnostic.html#cb41-15"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>)), </span>
<span id="cb41-16"><a href="exploration-diagnostic.html#cb41-16"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb41-17"><a href="exploration-diagnostic.html#cb41-17"></a>  <span class="dt">fit_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100000</span></span>
<span id="cb41-18"><a href="exploration-diagnostic.html#cb41-18"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>)), </span>
<span id="cb41-19"><a href="exploration-diagnostic.html#cb41-19"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>))),  </span>
<span id="cb41-20"><a href="exploration-diagnostic.html#cb41-20"></a>  <span class="dt">fit_fit_10000 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb41-21"><a href="exploration-diagnostic.html#cb41-21"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>)), </span>
<span id="cb41-22"><a href="exploration-diagnostic.html#cb41-22"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>))),</span>
<span id="cb41-23"><a href="exploration-diagnostic.html#cb41-23"></a>  <span class="dt">fit_fit_100000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb41-24"><a href="exploration-diagnostic.html#cb41-24"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)), </span>
<span id="cb41-25"><a href="exploration-diagnostic.html#cb41-25"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>))),  </span>
<span id="cb41-26"><a href="exploration-diagnostic.html#cb41-26"></a>  <span class="dt">fit_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE pheno -&gt; fit, lag 10</span></span>
<span id="cb41-27"><a href="exploration-diagnostic.html#cb41-27"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1</span>)), </span>
<span id="cb41-28"><a href="exploration-diagnostic.html#cb41-28"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb41-29"><a href="exploration-diagnostic.html#cb41-29"></a>  <span class="dt">fit_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100 </span></span>
<span id="cb41-30"><a href="exploration-diagnostic.html#cb41-30"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10</span>)), </span>
<span id="cb41-31"><a href="exploration-diagnostic.html#cb41-31"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb41-32"><a href="exploration-diagnostic.html#cb41-32"></a>  <span class="dt">fit_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 1000</span></span>
<span id="cb41-33"><a href="exploration-diagnostic.html#cb41-33"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">100</span>)), </span>
<span id="cb41-34"><a href="exploration-diagnostic.html#cb41-34"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb41-35"><a href="exploration-diagnostic.html#cb41-35"></a>  <span class="dt">fit_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 10000</span></span>
<span id="cb41-36"><a href="exploration-diagnostic.html#cb41-36"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1000</span>)), </span>
<span id="cb41-37"><a href="exploration-diagnostic.html#cb41-37"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb41-38"><a href="exploration-diagnostic.html#cb41-38"></a>  <span class="dt">fit_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100000</span></span>
<span id="cb41-39"><a href="exploration-diagnostic.html#cb41-39"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10000</span>)), </span>
<span id="cb41-40"><a href="exploration-diagnostic.html#cb41-40"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)))</span>
<span id="cb41-41"><a href="exploration-diagnostic.html#cb41-41"></a>)</span>
<span id="cb41-42"><a href="exploration-diagnostic.html#cb41-42"></a></span>
<span id="cb41-43"><a href="exploration-diagnostic.html#cb41-43"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb41-44"><a href="exploration-diagnostic.html#cb41-44"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;o_10&quot;</span>))</span>
<span id="cb41-45"><a href="exploration-diagnostic.html#cb41-45"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb41-46"><a href="exploration-diagnostic.html#cb41-46"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb41-47"><a href="exploration-diagnostic.html#cb41-47"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb41-48"><a href="exploration-diagnostic.html#cb41-48"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo&quot;</span>) <span class="op">~</span><span class="st"> &quot;Phylogenetic&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Phenotypic&quot;</span>)</span>
<span id="cb41-49"><a href="exploration-diagnostic.html#cb41-49"></a></span>
<span id="cb41-50"><a href="exploration-diagnostic.html#cb41-50"></a><span class="co"># Plot transfer entropy</span></span>
<span id="cb41-51"><a href="exploration-diagnostic.html#cb41-51"></a><span class="kw">ggplot</span>(</span>
<span id="cb41-52"><a href="exploration-diagnostic.html#cb41-52"></a>  res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(name, <span class="st">&quot;fit_ph*&quot;</span>)), </span>
<span id="cb41-53"><a href="exploration-diagnostic.html#cb41-53"></a>  <span class="kw">aes</span>(</span>
<span id="cb41-54"><a href="exploration-diagnostic.html#cb41-54"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb41-55"><a href="exploration-diagnostic.html#cb41-55"></a>    <span class="dt">y=</span>value, </span>
<span id="cb41-56"><a href="exploration-diagnostic.html#cb41-56"></a>    <span class="dt">color=</span>Type</span>
<span id="cb41-57"><a href="exploration-diagnostic.html#cb41-57"></a>    )</span>
<span id="cb41-58"><a href="exploration-diagnostic.html#cb41-58"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-59"><a href="exploration-diagnostic.html#cb41-59"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-60"><a href="exploration-diagnostic.html#cb41-60"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-61"><a href="exploration-diagnostic.html#cb41-61"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-62"><a href="exploration-diagnostic.html#cb41-62"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-63"><a href="exploration-diagnostic.html#cb41-63"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb41-64"><a href="exploration-diagnostic.html#cb41-64"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-65"><a href="exploration-diagnostic.html#cb41-65"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_mpd_shannon-1.png" width="672" /></p>
</div>
<div id="mean-evolutionary-distinctiveness-vs.-phenotypic-richness" class="section level4">
<h4><span class="header-section-number">2.7.1.4</span> Mean evolutionary distinctiveness vs. phenotypic richness</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="exploration-diagnostic.html#cb42-1"></a><span class="co"># Calculate transfer entropy for mean evolutionary distinctiveness</span></span>
<span id="cb42-2"><a href="exploration-diagnostic.html#cb42-2"></a><span class="co"># Time points are 10 generations, so calculating lag 1 gives us lag 10</span></span>
<span id="cb42-3"><a href="exploration-diagnostic.html#cb42-3"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb42-4"><a href="exploration-diagnostic.html#cb42-4"></a><span class="kw">summarise</span>(</span>
<span id="cb42-5"><a href="exploration-diagnostic.html#cb42-5"></a>  <span class="dt">fit_phylo_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10</span></span>
<span id="cb42-6"><a href="exploration-diagnostic.html#cb42-6"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1</span>)), </span>
<span id="cb42-7"><a href="exploration-diagnostic.html#cb42-7"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb42-8"><a href="exploration-diagnostic.html#cb42-8"></a>  <span class="dt">fit_phylo_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100</span></span>
<span id="cb42-9"><a href="exploration-diagnostic.html#cb42-9"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10</span>)), </span>
<span id="cb42-10"><a href="exploration-diagnostic.html#cb42-10"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb42-11"><a href="exploration-diagnostic.html#cb42-11"></a>  <span class="dt">fit_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 1000</span></span>
<span id="cb42-12"><a href="exploration-diagnostic.html#cb42-12"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">100</span>)), </span>
<span id="cb42-13"><a href="exploration-diagnostic.html#cb42-13"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb42-14"><a href="exploration-diagnostic.html#cb42-14"></a>  <span class="dt">fit_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10000</span></span>
<span id="cb42-15"><a href="exploration-diagnostic.html#cb42-15"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>)), </span>
<span id="cb42-16"><a href="exploration-diagnostic.html#cb42-16"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb42-17"><a href="exploration-diagnostic.html#cb42-17"></a>  <span class="dt">fit_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100000</span></span>
<span id="cb42-18"><a href="exploration-diagnostic.html#cb42-18"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>)), </span>
<span id="cb42-19"><a href="exploration-diagnostic.html#cb42-19"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>))),  </span>
<span id="cb42-20"><a href="exploration-diagnostic.html#cb42-20"></a>  <span class="dt">fit_fit_10000 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb42-21"><a href="exploration-diagnostic.html#cb42-21"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>)), </span>
<span id="cb42-22"><a href="exploration-diagnostic.html#cb42-22"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>))),</span>
<span id="cb42-23"><a href="exploration-diagnostic.html#cb42-23"></a>  <span class="dt">fit_fit_100000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb42-24"><a href="exploration-diagnostic.html#cb42-24"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)), </span>
<span id="cb42-25"><a href="exploration-diagnostic.html#cb42-25"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>))),  </span>
<span id="cb42-26"><a href="exploration-diagnostic.html#cb42-26"></a>  <span class="dt">fit_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE pheno -&gt; fit, lag 10</span></span>
<span id="cb42-27"><a href="exploration-diagnostic.html#cb42-27"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>)), </span>
<span id="cb42-28"><a href="exploration-diagnostic.html#cb42-28"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb42-29"><a href="exploration-diagnostic.html#cb42-29"></a>  <span class="dt">fit_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100 </span></span>
<span id="cb42-30"><a href="exploration-diagnostic.html#cb42-30"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>)), </span>
<span id="cb42-31"><a href="exploration-diagnostic.html#cb42-31"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb42-32"><a href="exploration-diagnostic.html#cb42-32"></a>  <span class="dt">fit_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 1000</span></span>
<span id="cb42-33"><a href="exploration-diagnostic.html#cb42-33"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>)), </span>
<span id="cb42-34"><a href="exploration-diagnostic.html#cb42-34"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb42-35"><a href="exploration-diagnostic.html#cb42-35"></a>  <span class="dt">fit_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 10000</span></span>
<span id="cb42-36"><a href="exploration-diagnostic.html#cb42-36"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>)), </span>
<span id="cb42-37"><a href="exploration-diagnostic.html#cb42-37"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb42-38"><a href="exploration-diagnostic.html#cb42-38"></a>  <span class="dt">fit_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100000</span></span>
<span id="cb42-39"><a href="exploration-diagnostic.html#cb42-39"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>)), </span>
<span id="cb42-40"><a href="exploration-diagnostic.html#cb42-40"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)))</span>
<span id="cb42-41"><a href="exploration-diagnostic.html#cb42-41"></a>)</span>
<span id="cb42-42"><a href="exploration-diagnostic.html#cb42-42"></a></span>
<span id="cb42-43"><a href="exploration-diagnostic.html#cb42-43"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb42-44"><a href="exploration-diagnostic.html#cb42-44"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;o_10&quot;</span>))</span>
<span id="cb42-45"><a href="exploration-diagnostic.html#cb42-45"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb42-46"><a href="exploration-diagnostic.html#cb42-46"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb42-47"><a href="exploration-diagnostic.html#cb42-47"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb42-48"><a href="exploration-diagnostic.html#cb42-48"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo&quot;</span>) <span class="op">~</span><span class="st"> &quot;Phylogenetic&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Phenotypic&quot;</span>)</span>
<span id="cb42-49"><a href="exploration-diagnostic.html#cb42-49"></a></span>
<span id="cb42-50"><a href="exploration-diagnostic.html#cb42-50"></a><span class="co"># Plot transfer entropy</span></span>
<span id="cb42-51"><a href="exploration-diagnostic.html#cb42-51"></a><span class="kw">ggplot</span>(</span>
<span id="cb42-52"><a href="exploration-diagnostic.html#cb42-52"></a>  res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(name, <span class="st">&quot;fit_ph*&quot;</span>)), </span>
<span id="cb42-53"><a href="exploration-diagnostic.html#cb42-53"></a>  <span class="kw">aes</span>(</span>
<span id="cb42-54"><a href="exploration-diagnostic.html#cb42-54"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb42-55"><a href="exploration-diagnostic.html#cb42-55"></a>    <span class="dt">y=</span>value, </span>
<span id="cb42-56"><a href="exploration-diagnostic.html#cb42-56"></a>    <span class="dt">color=</span>Type</span>
<span id="cb42-57"><a href="exploration-diagnostic.html#cb42-57"></a>    )</span>
<span id="cb42-58"><a href="exploration-diagnostic.html#cb42-58"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-59"><a href="exploration-diagnostic.html#cb42-59"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-60"><a href="exploration-diagnostic.html#cb42-60"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-61"><a href="exploration-diagnostic.html#cb42-61"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-62"><a href="exploration-diagnostic.html#cb42-62"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-63"><a href="exploration-diagnostic.html#cb42-63"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb42-64"><a href="exploration-diagnostic.html#cb42-64"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-65"><a href="exploration-diagnostic.html#cb42-65"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_med-1.png" width="672" /></p>
</div>
<div id="mean-evolutionary-distinctiveness-vs.-shannon-entropy" class="section level4">
<h4><span class="header-section-number">2.7.1.5</span> Mean evolutionary distinctiveness vs. shannon entropy</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="exploration-diagnostic.html#cb43-1"></a><span class="co"># Calculate transfer entropy for mean evolutionary distinctiveness</span></span>
<span id="cb43-2"><a href="exploration-diagnostic.html#cb43-2"></a><span class="co"># Time points are 10 generations, so calculating lag 1 gives us lag 10</span></span>
<span id="cb43-3"><a href="exploration-diagnostic.html#cb43-3"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb43-4"><a href="exploration-diagnostic.html#cb43-4"></a><span class="kw">summarise</span>(</span>
<span id="cb43-5"><a href="exploration-diagnostic.html#cb43-5"></a>  <span class="dt">fit_phylo_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10</span></span>
<span id="cb43-6"><a href="exploration-diagnostic.html#cb43-6"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1</span>)), </span>
<span id="cb43-7"><a href="exploration-diagnostic.html#cb43-7"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb43-8"><a href="exploration-diagnostic.html#cb43-8"></a>  <span class="dt">fit_phylo_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100</span></span>
<span id="cb43-9"><a href="exploration-diagnostic.html#cb43-9"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10</span>)), </span>
<span id="cb43-10"><a href="exploration-diagnostic.html#cb43-10"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb43-11"><a href="exploration-diagnostic.html#cb43-11"></a>  <span class="dt">fit_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 1000</span></span>
<span id="cb43-12"><a href="exploration-diagnostic.html#cb43-12"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">100</span>)), </span>
<span id="cb43-13"><a href="exploration-diagnostic.html#cb43-13"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb43-14"><a href="exploration-diagnostic.html#cb43-14"></a>  <span class="dt">fit_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 10000</span></span>
<span id="cb43-15"><a href="exploration-diagnostic.html#cb43-15"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>)), </span>
<span id="cb43-16"><a href="exploration-diagnostic.html#cb43-16"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb43-17"><a href="exploration-diagnostic.html#cb43-17"></a>  <span class="dt">fit_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE phylo -&gt; fit, lag 100000</span></span>
<span id="cb43-18"><a href="exploration-diagnostic.html#cb43-18"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>)), </span>
<span id="cb43-19"><a href="exploration-diagnostic.html#cb43-19"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>))),  </span>
<span id="cb43-20"><a href="exploration-diagnostic.html#cb43-20"></a>  <span class="dt">fit_fit_10000 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb43-21"><a href="exploration-diagnostic.html#cb43-21"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>)), </span>
<span id="cb43-22"><a href="exploration-diagnostic.html#cb43-22"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>))),</span>
<span id="cb43-23"><a href="exploration-diagnostic.html#cb43-23"></a>  <span class="dt">fit_fit_100000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># Mutual info btwn. fit and lagged fit</span></span>
<span id="cb43-24"><a href="exploration-diagnostic.html#cb43-24"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)), </span>
<span id="cb43-25"><a href="exploration-diagnostic.html#cb43-25"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>))),  </span>
<span id="cb43-26"><a href="exploration-diagnostic.html#cb43-26"></a>  <span class="dt">fit_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg), <span class="co"># TE pheno -&gt; fit, lag 10</span></span>
<span id="cb43-27"><a href="exploration-diagnostic.html#cb43-27"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1</span>)), </span>
<span id="cb43-28"><a href="exploration-diagnostic.html#cb43-28"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1</span>))),</span>
<span id="cb43-29"><a href="exploration-diagnostic.html#cb43-29"></a>  <span class="dt">fit_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100 </span></span>
<span id="cb43-30"><a href="exploration-diagnostic.html#cb43-30"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10</span>)), </span>
<span id="cb43-31"><a href="exploration-diagnostic.html#cb43-31"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10</span>))),</span>
<span id="cb43-32"><a href="exploration-diagnostic.html#cb43-32"></a>  <span class="dt">fit_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 1000</span></span>
<span id="cb43-33"><a href="exploration-diagnostic.html#cb43-33"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">100</span>)), </span>
<span id="cb43-34"><a href="exploration-diagnostic.html#cb43-34"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">100</span>))),</span>
<span id="cb43-35"><a href="exploration-diagnostic.html#cb43-35"></a>  <span class="dt">fit_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 10000</span></span>
<span id="cb43-36"><a href="exploration-diagnostic.html#cb43-36"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1000</span>)), </span>
<span id="cb43-37"><a href="exploration-diagnostic.html#cb43-37"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">1000</span>))),</span>
<span id="cb43-38"><a href="exploration-diagnostic.html#cb43-38"></a>  <span class="dt">fit_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(elite_trait_avg),  <span class="co"># TE pheno -&gt; fit, lag 100000</span></span>
<span id="cb43-39"><a href="exploration-diagnostic.html#cb43-39"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10000</span>)), </span>
<span id="cb43-40"><a href="exploration-diagnostic.html#cb43-40"></a>                                     <span class="kw">discretize</span>(<span class="kw">lag</span>(elite_trait_avg, <span class="dv">10000</span>)))</span>
<span id="cb43-41"><a href="exploration-diagnostic.html#cb43-41"></a>)</span>
<span id="cb43-42"><a href="exploration-diagnostic.html#cb43-42"></a></span>
<span id="cb43-43"><a href="exploration-diagnostic.html#cb43-43"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb43-44"><a href="exploration-diagnostic.html#cb43-44"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;o_10&quot;</span>))</span>
<span id="cb43-45"><a href="exploration-diagnostic.html#cb43-45"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb43-46"><a href="exploration-diagnostic.html#cb43-46"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb43-47"><a href="exploration-diagnostic.html#cb43-47"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb43-48"><a href="exploration-diagnostic.html#cb43-48"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo&quot;</span>) <span class="op">~</span><span class="st"> &quot;Phylogenetic&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Phenotypic&quot;</span>)</span>
<span id="cb43-49"><a href="exploration-diagnostic.html#cb43-49"></a></span>
<span id="cb43-50"><a href="exploration-diagnostic.html#cb43-50"></a><span class="co"># Plot transfer entropy</span></span>
<span id="cb43-51"><a href="exploration-diagnostic.html#cb43-51"></a><span class="kw">ggplot</span>(</span>
<span id="cb43-52"><a href="exploration-diagnostic.html#cb43-52"></a>  res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(name, <span class="st">&quot;fit_ph*&quot;</span>)), </span>
<span id="cb43-53"><a href="exploration-diagnostic.html#cb43-53"></a>  <span class="kw">aes</span>(</span>
<span id="cb43-54"><a href="exploration-diagnostic.html#cb43-54"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb43-55"><a href="exploration-diagnostic.html#cb43-55"></a>    <span class="dt">y=</span>value, </span>
<span id="cb43-56"><a href="exploration-diagnostic.html#cb43-56"></a>    <span class="dt">color=</span>Type</span>
<span id="cb43-57"><a href="exploration-diagnostic.html#cb43-57"></a>    )</span>
<span id="cb43-58"><a href="exploration-diagnostic.html#cb43-58"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-59"><a href="exploration-diagnostic.html#cb43-59"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-60"><a href="exploration-diagnostic.html#cb43-60"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-61"><a href="exploration-diagnostic.html#cb43-61"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-62"><a href="exploration-diagnostic.html#cb43-62"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-63"><a href="exploration-diagnostic.html#cb43-63"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb43-64"><a href="exploration-diagnostic.html#cb43-64"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-65"><a href="exploration-diagnostic.html#cb43-65"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_med_shannon-1.png" width="672" /></p>
</div>
</div>
<div id="transfer-entropy-between-types-of-diversity" class="section level3">
<h3><span class="header-section-number">2.7.2</span> Transfer entropy between types of diversity</h3>
<div id="max-pairwise-distance-and-phenotypic-richness" class="section level4">
<h4><span class="header-section-number">2.7.2.1</span> Max pairwise distance and phenotypic richness</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="exploration-diagnostic.html#cb44-1"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb44-2"><a href="exploration-diagnostic.html#cb44-2"></a><span class="kw">summarise</span>(</span>
<span id="cb44-3"><a href="exploration-diagnostic.html#cb44-3"></a>  <span class="dt">phen_phylo_10 =</span>      <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa), </span>
<span id="cb44-4"><a href="exploration-diagnostic.html#cb44-4"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">1</span>)), </span>
<span id="cb44-5"><a href="exploration-diagnostic.html#cb44-5"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>))),</span>
<span id="cb44-6"><a href="exploration-diagnostic.html#cb44-6"></a>  <span class="dt">phen_phylo_100 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb44-7"><a href="exploration-diagnostic.html#cb44-7"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">10</span>)),</span>
<span id="cb44-8"><a href="exploration-diagnostic.html#cb44-8"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>))),</span>
<span id="cb44-9"><a href="exploration-diagnostic.html#cb44-9"></a>  <span class="dt">pheno_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb44-10"><a href="exploration-diagnostic.html#cb44-10"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">100</span>)),</span>
<span id="cb44-11"><a href="exploration-diagnostic.html#cb44-11"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>))),</span>
<span id="cb44-12"><a href="exploration-diagnostic.html#cb44-12"></a>  <span class="dt">pheno_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb44-13"><a href="exploration-diagnostic.html#cb44-13"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">1000</span>)),</span>
<span id="cb44-14"><a href="exploration-diagnostic.html#cb44-14"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>))),</span>
<span id="cb44-15"><a href="exploration-diagnostic.html#cb44-15"></a>  <span class="dt">pheno_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb44-16"><a href="exploration-diagnostic.html#cb44-16"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">10000</span>)),</span>
<span id="cb44-17"><a href="exploration-diagnostic.html#cb44-17"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>))),</span>
<span id="cb44-18"><a href="exploration-diagnostic.html#cb44-18"></a>  </span>
<span id="cb44-19"><a href="exploration-diagnostic.html#cb44-19"></a>  <span class="dt">phylo_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(max_phenotype_pairwise_distance),</span>
<span id="cb44-20"><a href="exploration-diagnostic.html#cb44-20"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>)),</span>
<span id="cb44-21"><a href="exploration-diagnostic.html#cb44-21"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">1</span>))),</span>
<span id="cb44-22"><a href="exploration-diagnostic.html#cb44-22"></a>  <span class="dt">phylo_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(max_phenotype_pairwise_distance),</span>
<span id="cb44-23"><a href="exploration-diagnostic.html#cb44-23"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>)),</span>
<span id="cb44-24"><a href="exploration-diagnostic.html#cb44-24"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">10</span>))),</span>
<span id="cb44-25"><a href="exploration-diagnostic.html#cb44-25"></a>  <span class="dt">phylo_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(max_phenotype_pairwise_distance),</span>
<span id="cb44-26"><a href="exploration-diagnostic.html#cb44-26"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>)),</span>
<span id="cb44-27"><a href="exploration-diagnostic.html#cb44-27"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">100</span>))),</span>
<span id="cb44-28"><a href="exploration-diagnostic.html#cb44-28"></a>  <span class="dt">phylo_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(max_phenotype_pairwise_distance),</span>
<span id="cb44-29"><a href="exploration-diagnostic.html#cb44-29"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>)),</span>
<span id="cb44-30"><a href="exploration-diagnostic.html#cb44-30"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">1000</span>))),</span>
<span id="cb44-31"><a href="exploration-diagnostic.html#cb44-31"></a>  <span class="dt">phylo_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(max_phenotype_pairwise_distance),</span>
<span id="cb44-32"><a href="exploration-diagnostic.html#cb44-32"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>)),</span>
<span id="cb44-33"><a href="exploration-diagnostic.html#cb44-33"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(max_phenotype_pairwise_distance, <span class="dv">10000</span>)))</span>
<span id="cb44-34"><a href="exploration-diagnostic.html#cb44-34"></a>)</span>
<span id="cb44-35"><a href="exploration-diagnostic.html#cb44-35"></a></span>
<span id="cb44-36"><a href="exploration-diagnostic.html#cb44-36"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb44-37"><a href="exploration-diagnostic.html#cb44-37"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;phylo&quot;</span>))</span>
<span id="cb44-38"><a href="exploration-diagnostic.html#cb44-38"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb44-39"><a href="exploration-diagnostic.html#cb44-39"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb44-40"><a href="exploration-diagnostic.html#cb44-40"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb44-41"><a href="exploration-diagnostic.html#cb44-41"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo_pheno&quot;</span>) <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-42"><a href="exploration-diagnostic.html#cb44-42"></a></span>
<span id="cb44-43"><a href="exploration-diagnostic.html#cb44-43"></a><span class="kw">ggplot</span>(</span>
<span id="cb44-44"><a href="exploration-diagnostic.html#cb44-44"></a>  res, </span>
<span id="cb44-45"><a href="exploration-diagnostic.html#cb44-45"></a>  <span class="kw">aes</span>(</span>
<span id="cb44-46"><a href="exploration-diagnostic.html#cb44-46"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb44-47"><a href="exploration-diagnostic.html#cb44-47"></a>    <span class="dt">y=</span>value, </span>
<span id="cb44-48"><a href="exploration-diagnostic.html#cb44-48"></a>    <span class="dt">color=</span>Type</span>
<span id="cb44-49"><a href="exploration-diagnostic.html#cb44-49"></a>    )</span>
<span id="cb44-50"><a href="exploration-diagnostic.html#cb44-50"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-51"><a href="exploration-diagnostic.html#cb44-51"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-52"><a href="exploration-diagnostic.html#cb44-52"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-53"><a href="exploration-diagnostic.html#cb44-53"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-54"><a href="exploration-diagnostic.html#cb44-54"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-55"><a href="exploration-diagnostic.html#cb44-55"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb44-56"><a href="exploration-diagnostic.html#cb44-56"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-57"><a href="exploration-diagnostic.html#cb44-57"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_pheno_phylo-1.png" width="672" /></p>
</div>
<div id="mean-pairwise-distance-and-phenotypic-richness" class="section level4">
<h4><span class="header-section-number">2.7.2.2</span> Mean pairwise distance and phenotypic richness</h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="exploration-diagnostic.html#cb45-1"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb45-2"><a href="exploration-diagnostic.html#cb45-2"></a><span class="kw">summarise</span>(</span>
<span id="cb45-3"><a href="exploration-diagnostic.html#cb45-3"></a>  <span class="dt">phen_phylo_10 =</span>      <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa), </span>
<span id="cb45-4"><a href="exploration-diagnostic.html#cb45-4"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1</span>)), </span>
<span id="cb45-5"><a href="exploration-diagnostic.html#cb45-5"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>))),</span>
<span id="cb45-6"><a href="exploration-diagnostic.html#cb45-6"></a>  <span class="dt">phen_phylo_100 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb45-7"><a href="exploration-diagnostic.html#cb45-7"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10</span>)),</span>
<span id="cb45-8"><a href="exploration-diagnostic.html#cb45-8"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>))),</span>
<span id="cb45-9"><a href="exploration-diagnostic.html#cb45-9"></a>  <span class="dt">pheno_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb45-10"><a href="exploration-diagnostic.html#cb45-10"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">100</span>)),</span>
<span id="cb45-11"><a href="exploration-diagnostic.html#cb45-11"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>))),</span>
<span id="cb45-12"><a href="exploration-diagnostic.html#cb45-12"></a>  <span class="dt">pheno_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb45-13"><a href="exploration-diagnostic.html#cb45-13"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>)),</span>
<span id="cb45-14"><a href="exploration-diagnostic.html#cb45-14"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>))),</span>
<span id="cb45-15"><a href="exploration-diagnostic.html#cb45-15"></a>  <span class="dt">pheno_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb45-16"><a href="exploration-diagnostic.html#cb45-16"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>)),</span>
<span id="cb45-17"><a href="exploration-diagnostic.html#cb45-17"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>))),</span>
<span id="cb45-18"><a href="exploration-diagnostic.html#cb45-18"></a>  </span>
<span id="cb45-19"><a href="exploration-diagnostic.html#cb45-19"></a>  <span class="dt">phylo_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb45-20"><a href="exploration-diagnostic.html#cb45-20"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>)),</span>
<span id="cb45-21"><a href="exploration-diagnostic.html#cb45-21"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1</span>))),</span>
<span id="cb45-22"><a href="exploration-diagnostic.html#cb45-22"></a>  <span class="dt">phylo_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb45-23"><a href="exploration-diagnostic.html#cb45-23"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>)),</span>
<span id="cb45-24"><a href="exploration-diagnostic.html#cb45-24"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10</span>))),</span>
<span id="cb45-25"><a href="exploration-diagnostic.html#cb45-25"></a>  <span class="dt">phylo_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb45-26"><a href="exploration-diagnostic.html#cb45-26"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>)),</span>
<span id="cb45-27"><a href="exploration-diagnostic.html#cb45-27"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">100</span>))),</span>
<span id="cb45-28"><a href="exploration-diagnostic.html#cb45-28"></a>  <span class="dt">phylo_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb45-29"><a href="exploration-diagnostic.html#cb45-29"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>)),</span>
<span id="cb45-30"><a href="exploration-diagnostic.html#cb45-30"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>))),</span>
<span id="cb45-31"><a href="exploration-diagnostic.html#cb45-31"></a>  <span class="dt">phylo_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb45-32"><a href="exploration-diagnostic.html#cb45-32"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>)),</span>
<span id="cb45-33"><a href="exploration-diagnostic.html#cb45-33"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>)))</span>
<span id="cb45-34"><a href="exploration-diagnostic.html#cb45-34"></a>)</span>
<span id="cb45-35"><a href="exploration-diagnostic.html#cb45-35"></a></span>
<span id="cb45-36"><a href="exploration-diagnostic.html#cb45-36"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb45-37"><a href="exploration-diagnostic.html#cb45-37"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;phylo&quot;</span>))</span>
<span id="cb45-38"><a href="exploration-diagnostic.html#cb45-38"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb45-39"><a href="exploration-diagnostic.html#cb45-39"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb45-40"><a href="exploration-diagnostic.html#cb45-40"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb45-41"><a href="exploration-diagnostic.html#cb45-41"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo_pheno&quot;</span>) <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb45-42"><a href="exploration-diagnostic.html#cb45-42"></a></span>
<span id="cb45-43"><a href="exploration-diagnostic.html#cb45-43"></a><span class="kw">ggplot</span>(</span>
<span id="cb45-44"><a href="exploration-diagnostic.html#cb45-44"></a>  res, </span>
<span id="cb45-45"><a href="exploration-diagnostic.html#cb45-45"></a>  <span class="kw">aes</span>(</span>
<span id="cb45-46"><a href="exploration-diagnostic.html#cb45-46"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb45-47"><a href="exploration-diagnostic.html#cb45-47"></a>    <span class="dt">y=</span>value, </span>
<span id="cb45-48"><a href="exploration-diagnostic.html#cb45-48"></a>    <span class="dt">color=</span>Type</span>
<span id="cb45-49"><a href="exploration-diagnostic.html#cb45-49"></a>    )</span>
<span id="cb45-50"><a href="exploration-diagnostic.html#cb45-50"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-51"><a href="exploration-diagnostic.html#cb45-51"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-52"><a href="exploration-diagnostic.html#cb45-52"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-53"><a href="exploration-diagnostic.html#cb45-53"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-54"><a href="exploration-diagnostic.html#cb45-54"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-55"><a href="exploration-diagnostic.html#cb45-55"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb45-56"><a href="exploration-diagnostic.html#cb45-56"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-57"><a href="exploration-diagnostic.html#cb45-57"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_pheno_phylo_mpd-1.png" width="672" /></p>
</div>
<div id="mean-pairwise-distance-and-shannon-diversity" class="section level4">
<h4><span class="header-section-number">2.7.2.3</span> Mean pairwise distance and shannon diversity</h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="exploration-diagnostic.html#cb46-1"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb46-2"><a href="exploration-diagnostic.html#cb46-2"></a><span class="kw">summarise</span>(</span>
<span id="cb46-3"><a href="exploration-diagnostic.html#cb46-3"></a>  <span class="dt">phen_phylo_10 =</span>      <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_diversity), </span>
<span id="cb46-4"><a href="exploration-diagnostic.html#cb46-4"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1</span>)), </span>
<span id="cb46-5"><a href="exploration-diagnostic.html#cb46-5"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1</span>))),</span>
<span id="cb46-6"><a href="exploration-diagnostic.html#cb46-6"></a>  <span class="dt">phen_phylo_100 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb46-7"><a href="exploration-diagnostic.html#cb46-7"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10</span>)),</span>
<span id="cb46-8"><a href="exploration-diagnostic.html#cb46-8"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10</span>))),</span>
<span id="cb46-9"><a href="exploration-diagnostic.html#cb46-9"></a>  <span class="dt">pheno_phylo_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb46-10"><a href="exploration-diagnostic.html#cb46-10"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">100</span>)),</span>
<span id="cb46-11"><a href="exploration-diagnostic.html#cb46-11"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">100</span>))),</span>
<span id="cb46-12"><a href="exploration-diagnostic.html#cb46-12"></a>  <span class="dt">pheno_phylo_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb46-13"><a href="exploration-diagnostic.html#cb46-13"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>)),</span>
<span id="cb46-14"><a href="exploration-diagnostic.html#cb46-14"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1000</span>))),</span>
<span id="cb46-15"><a href="exploration-diagnostic.html#cb46-15"></a>  <span class="dt">pheno_phylo_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb46-16"><a href="exploration-diagnostic.html#cb46-16"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>)),</span>
<span id="cb46-17"><a href="exploration-diagnostic.html#cb46-17"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10000</span>))),</span>
<span id="cb46-18"><a href="exploration-diagnostic.html#cb46-18"></a>  </span>
<span id="cb46-19"><a href="exploration-diagnostic.html#cb46-19"></a>  <span class="dt">phylo_pheno_10 =</span>     <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb46-20"><a href="exploration-diagnostic.html#cb46-20"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1</span>)),</span>
<span id="cb46-21"><a href="exploration-diagnostic.html#cb46-21"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1</span>))),</span>
<span id="cb46-22"><a href="exploration-diagnostic.html#cb46-22"></a>  <span class="dt">phylo_pheno_100 =</span>    <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb46-23"><a href="exploration-diagnostic.html#cb46-23"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10</span>)),</span>
<span id="cb46-24"><a href="exploration-diagnostic.html#cb46-24"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10</span>))),</span>
<span id="cb46-25"><a href="exploration-diagnostic.html#cb46-25"></a>  <span class="dt">phylo_pheno_1000 =</span>   <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb46-26"><a href="exploration-diagnostic.html#cb46-26"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">100</span>)),</span>
<span id="cb46-27"><a href="exploration-diagnostic.html#cb46-27"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">100</span>))),</span>
<span id="cb46-28"><a href="exploration-diagnostic.html#cb46-28"></a>  <span class="dt">phylo_pheno_10000 =</span>  <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb46-29"><a href="exploration-diagnostic.html#cb46-29"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1000</span>)),</span>
<span id="cb46-30"><a href="exploration-diagnostic.html#cb46-30"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">1000</span>))),</span>
<span id="cb46-31"><a href="exploration-diagnostic.html#cb46-31"></a>  <span class="dt">phylo_pheno_100000 =</span> <span class="kw">condinformation</span>(<span class="kw">discretize</span>(mean_phenotype_pairwise_distance),</span>
<span id="cb46-32"><a href="exploration-diagnostic.html#cb46-32"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10000</span>)),</span>
<span id="cb46-33"><a href="exploration-diagnostic.html#cb46-33"></a>                                       <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_pairwise_distance, <span class="dv">10000</span>)))</span>
<span id="cb46-34"><a href="exploration-diagnostic.html#cb46-34"></a>)</span>
<span id="cb46-35"><a href="exploration-diagnostic.html#cb46-35"></a></span>
<span id="cb46-36"><a href="exploration-diagnostic.html#cb46-36"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb46-37"><a href="exploration-diagnostic.html#cb46-37"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;phylo&quot;</span>))</span>
<span id="cb46-38"><a href="exploration-diagnostic.html#cb46-38"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb46-39"><a href="exploration-diagnostic.html#cb46-39"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb46-40"><a href="exploration-diagnostic.html#cb46-40"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb46-41"><a href="exploration-diagnostic.html#cb46-41"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo_pheno&quot;</span>) <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-42"><a href="exploration-diagnostic.html#cb46-42"></a></span>
<span id="cb46-43"><a href="exploration-diagnostic.html#cb46-43"></a><span class="kw">ggplot</span>(</span>
<span id="cb46-44"><a href="exploration-diagnostic.html#cb46-44"></a>  res, </span>
<span id="cb46-45"><a href="exploration-diagnostic.html#cb46-45"></a>  <span class="kw">aes</span>(</span>
<span id="cb46-46"><a href="exploration-diagnostic.html#cb46-46"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb46-47"><a href="exploration-diagnostic.html#cb46-47"></a>    <span class="dt">y=</span>value, </span>
<span id="cb46-48"><a href="exploration-diagnostic.html#cb46-48"></a>    <span class="dt">color=</span>Type</span>
<span id="cb46-49"><a href="exploration-diagnostic.html#cb46-49"></a>    )</span>
<span id="cb46-50"><a href="exploration-diagnostic.html#cb46-50"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-51"><a href="exploration-diagnostic.html#cb46-51"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-52"><a href="exploration-diagnostic.html#cb46-52"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-53"><a href="exploration-diagnostic.html#cb46-53"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-54"><a href="exploration-diagnostic.html#cb46-54"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-55"><a href="exploration-diagnostic.html#cb46-55"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb46-56"><a href="exploration-diagnostic.html#cb46-56"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-57"><a href="exploration-diagnostic.html#cb46-57"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_pheno_phylo_mpd_shannon-1.png" width="672" /></p>
</div>
<div id="mean-evolutionary-distinctiveness-and-phenotypic-richness" class="section level4">
<h4><span class="header-section-number">2.7.2.4</span> Mean evolutionary distinctiveness and phenotypic richness</h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="exploration-diagnostic.html#cb47-1"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb47-2"><a href="exploration-diagnostic.html#cb47-2"></a><span class="kw">summarise</span>(</span>
<span id="cb47-3"><a href="exploration-diagnostic.html#cb47-3"></a>  <span class="dt">phen_phylo_10 =</span>      <span class="kw">condinformation</span>(</span>
<span id="cb47-4"><a href="exploration-diagnostic.html#cb47-4"></a>                          <span class="kw">discretize</span>(phen_num_taxa), </span>
<span id="cb47-5"><a href="exploration-diagnostic.html#cb47-5"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1</span>)), </span>
<span id="cb47-6"><a href="exploration-diagnostic.html#cb47-6"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>))),</span>
<span id="cb47-7"><a href="exploration-diagnostic.html#cb47-7"></a>  <span class="dt">phen_phylo_100 =</span>     <span class="kw">condinformation</span>(</span>
<span id="cb47-8"><a href="exploration-diagnostic.html#cb47-8"></a>                          <span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb47-9"><a href="exploration-diagnostic.html#cb47-9"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10</span>)),</span>
<span id="cb47-10"><a href="exploration-diagnostic.html#cb47-10"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>))),</span>
<span id="cb47-11"><a href="exploration-diagnostic.html#cb47-11"></a>  <span class="dt">pheno_phylo_1000 =</span>   <span class="kw">condinformation</span>(</span>
<span id="cb47-12"><a href="exploration-diagnostic.html#cb47-12"></a>                          <span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb47-13"><a href="exploration-diagnostic.html#cb47-13"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">100</span>)),</span>
<span id="cb47-14"><a href="exploration-diagnostic.html#cb47-14"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>))),</span>
<span id="cb47-15"><a href="exploration-diagnostic.html#cb47-15"></a>  <span class="dt">pheno_phylo_10000 =</span>  <span class="kw">condinformation</span>(</span>
<span id="cb47-16"><a href="exploration-diagnostic.html#cb47-16"></a>                          <span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb47-17"><a href="exploration-diagnostic.html#cb47-17"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>)),</span>
<span id="cb47-18"><a href="exploration-diagnostic.html#cb47-18"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>))),</span>
<span id="cb47-19"><a href="exploration-diagnostic.html#cb47-19"></a>  <span class="dt">pheno_phylo_100000 =</span> <span class="kw">condinformation</span>(</span>
<span id="cb47-20"><a href="exploration-diagnostic.html#cb47-20"></a>                          <span class="kw">discretize</span>(phen_num_taxa),</span>
<span id="cb47-21"><a href="exploration-diagnostic.html#cb47-21"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>)),</span>
<span id="cb47-22"><a href="exploration-diagnostic.html#cb47-22"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>))),</span>
<span id="cb47-23"><a href="exploration-diagnostic.html#cb47-23"></a>  </span>
<span id="cb47-24"><a href="exploration-diagnostic.html#cb47-24"></a>  <span class="dt">phylo_pheno_10 =</span>     <span class="kw">condinformation</span>(</span>
<span id="cb47-25"><a href="exploration-diagnostic.html#cb47-25"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb47-26"><a href="exploration-diagnostic.html#cb47-26"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1</span>)),</span>
<span id="cb47-27"><a href="exploration-diagnostic.html#cb47-27"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1</span>))),</span>
<span id="cb47-28"><a href="exploration-diagnostic.html#cb47-28"></a>  <span class="dt">phylo_pheno_100 =</span>    <span class="kw">condinformation</span>(</span>
<span id="cb47-29"><a href="exploration-diagnostic.html#cb47-29"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb47-30"><a href="exploration-diagnostic.html#cb47-30"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10</span>)),</span>
<span id="cb47-31"><a href="exploration-diagnostic.html#cb47-31"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10</span>))),</span>
<span id="cb47-32"><a href="exploration-diagnostic.html#cb47-32"></a>  <span class="dt">phylo_pheno_1000 =</span>   <span class="kw">condinformation</span>(</span>
<span id="cb47-33"><a href="exploration-diagnostic.html#cb47-33"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb47-34"><a href="exploration-diagnostic.html#cb47-34"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">100</span>)),</span>
<span id="cb47-35"><a href="exploration-diagnostic.html#cb47-35"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">100</span>))),</span>
<span id="cb47-36"><a href="exploration-diagnostic.html#cb47-36"></a>  <span class="dt">phylo_pheno_10000 =</span>  <span class="kw">condinformation</span>(</span>
<span id="cb47-37"><a href="exploration-diagnostic.html#cb47-37"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb47-38"><a href="exploration-diagnostic.html#cb47-38"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">1000</span>)),</span>
<span id="cb47-39"><a href="exploration-diagnostic.html#cb47-39"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>))),</span>
<span id="cb47-40"><a href="exploration-diagnostic.html#cb47-40"></a>  <span class="dt">phylo_pheno_100000 =</span> <span class="kw">condinformation</span>(</span>
<span id="cb47-41"><a href="exploration-diagnostic.html#cb47-41"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb47-42"><a href="exploration-diagnostic.html#cb47-42"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_num_taxa, <span class="dv">10000</span>)),</span>
<span id="cb47-43"><a href="exploration-diagnostic.html#cb47-43"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>)))</span>
<span id="cb47-44"><a href="exploration-diagnostic.html#cb47-44"></a>)</span>
<span id="cb47-45"><a href="exploration-diagnostic.html#cb47-45"></a></span>
<span id="cb47-46"><a href="exploration-diagnostic.html#cb47-46"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb47-47"><a href="exploration-diagnostic.html#cb47-47"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;phylo&quot;</span>))</span>
<span id="cb47-48"><a href="exploration-diagnostic.html#cb47-48"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb47-49"><a href="exploration-diagnostic.html#cb47-49"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb47-50"><a href="exploration-diagnostic.html#cb47-50"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb47-51"><a href="exploration-diagnostic.html#cb47-51"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo_pheno&quot;</span>) <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb47-52"><a href="exploration-diagnostic.html#cb47-52"></a></span>
<span id="cb47-53"><a href="exploration-diagnostic.html#cb47-53"></a><span class="kw">ggplot</span>(</span>
<span id="cb47-54"><a href="exploration-diagnostic.html#cb47-54"></a>  res, </span>
<span id="cb47-55"><a href="exploration-diagnostic.html#cb47-55"></a>  <span class="kw">aes</span>(</span>
<span id="cb47-56"><a href="exploration-diagnostic.html#cb47-56"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb47-57"><a href="exploration-diagnostic.html#cb47-57"></a>    <span class="dt">y=</span>value, </span>
<span id="cb47-58"><a href="exploration-diagnostic.html#cb47-58"></a>    <span class="dt">color=</span>Type</span>
<span id="cb47-59"><a href="exploration-diagnostic.html#cb47-59"></a>    )</span>
<span id="cb47-60"><a href="exploration-diagnostic.html#cb47-60"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-61"><a href="exploration-diagnostic.html#cb47-61"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-62"><a href="exploration-diagnostic.html#cb47-62"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-63"><a href="exploration-diagnostic.html#cb47-63"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-64"><a href="exploration-diagnostic.html#cb47-64"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-65"><a href="exploration-diagnostic.html#cb47-65"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb47-66"><a href="exploration-diagnostic.html#cb47-66"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-67"><a href="exploration-diagnostic.html#cb47-67"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_pheno_phylo_med-1.png" width="672" /></p>
</div>
<div id="mean-evolutionary-distinctiveness-and-shannon-diversity" class="section level4">
<h4><span class="header-section-number">2.7.2.5</span> Mean evolutionary distinctiveness and shannon diversity</h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="exploration-diagnostic.html#cb48-1"></a>res &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(directory, selection_name) <span class="op">%&gt;%</span></span>
<span id="cb48-2"><a href="exploration-diagnostic.html#cb48-2"></a><span class="kw">summarise</span>(</span>
<span id="cb48-3"><a href="exploration-diagnostic.html#cb48-3"></a>  <span class="dt">phen_phylo_10 =</span>      <span class="kw">condinformation</span>(</span>
<span id="cb48-4"><a href="exploration-diagnostic.html#cb48-4"></a>                          <span class="kw">discretize</span>(phen_diversity), </span>
<span id="cb48-5"><a href="exploration-diagnostic.html#cb48-5"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1</span>)), </span>
<span id="cb48-6"><a href="exploration-diagnostic.html#cb48-6"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1</span>))),</span>
<span id="cb48-7"><a href="exploration-diagnostic.html#cb48-7"></a>  <span class="dt">phen_phylo_100 =</span>     <span class="kw">condinformation</span>(</span>
<span id="cb48-8"><a href="exploration-diagnostic.html#cb48-8"></a>                          <span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb48-9"><a href="exploration-diagnostic.html#cb48-9"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10</span>)),</span>
<span id="cb48-10"><a href="exploration-diagnostic.html#cb48-10"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10</span>))),</span>
<span id="cb48-11"><a href="exploration-diagnostic.html#cb48-11"></a>  <span class="dt">pheno_phylo_1000 =</span>   <span class="kw">condinformation</span>(</span>
<span id="cb48-12"><a href="exploration-diagnostic.html#cb48-12"></a>                          <span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb48-13"><a href="exploration-diagnostic.html#cb48-13"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">100</span>)),</span>
<span id="cb48-14"><a href="exploration-diagnostic.html#cb48-14"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">100</span>))),</span>
<span id="cb48-15"><a href="exploration-diagnostic.html#cb48-15"></a>  <span class="dt">pheno_phylo_10000 =</span>  <span class="kw">condinformation</span>(</span>
<span id="cb48-16"><a href="exploration-diagnostic.html#cb48-16"></a>                          <span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb48-17"><a href="exploration-diagnostic.html#cb48-17"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>)),</span>
<span id="cb48-18"><a href="exploration-diagnostic.html#cb48-18"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1000</span>))),</span>
<span id="cb48-19"><a href="exploration-diagnostic.html#cb48-19"></a>  <span class="dt">pheno_phylo_100000 =</span> <span class="kw">condinformation</span>(</span>
<span id="cb48-20"><a href="exploration-diagnostic.html#cb48-20"></a>                          <span class="kw">discretize</span>(phen_diversity),</span>
<span id="cb48-21"><a href="exploration-diagnostic.html#cb48-21"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>)),</span>
<span id="cb48-22"><a href="exploration-diagnostic.html#cb48-22"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10000</span>))),</span>
<span id="cb48-23"><a href="exploration-diagnostic.html#cb48-23"></a>  </span>
<span id="cb48-24"><a href="exploration-diagnostic.html#cb48-24"></a>  <span class="dt">phylo_pheno_10 =</span>     <span class="kw">condinformation</span>(</span>
<span id="cb48-25"><a href="exploration-diagnostic.html#cb48-25"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb48-26"><a href="exploration-diagnostic.html#cb48-26"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1</span>)),</span>
<span id="cb48-27"><a href="exploration-diagnostic.html#cb48-27"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1</span>))),</span>
<span id="cb48-28"><a href="exploration-diagnostic.html#cb48-28"></a>  <span class="dt">phylo_pheno_100 =</span>    <span class="kw">condinformation</span>(</span>
<span id="cb48-29"><a href="exploration-diagnostic.html#cb48-29"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb48-30"><a href="exploration-diagnostic.html#cb48-30"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10</span>)),</span>
<span id="cb48-31"><a href="exploration-diagnostic.html#cb48-31"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10</span>))),</span>
<span id="cb48-32"><a href="exploration-diagnostic.html#cb48-32"></a>  <span class="dt">phylo_pheno_1000 =</span>   <span class="kw">condinformation</span>(</span>
<span id="cb48-33"><a href="exploration-diagnostic.html#cb48-33"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb48-34"><a href="exploration-diagnostic.html#cb48-34"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">100</span>)),</span>
<span id="cb48-35"><a href="exploration-diagnostic.html#cb48-35"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">100</span>))),</span>
<span id="cb48-36"><a href="exploration-diagnostic.html#cb48-36"></a>  <span class="dt">phylo_pheno_10000 =</span>  <span class="kw">condinformation</span>(</span>
<span id="cb48-37"><a href="exploration-diagnostic.html#cb48-37"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb48-38"><a href="exploration-diagnostic.html#cb48-38"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">1000</span>)),</span>
<span id="cb48-39"><a href="exploration-diagnostic.html#cb48-39"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">1000</span>))),</span>
<span id="cb48-40"><a href="exploration-diagnostic.html#cb48-40"></a>  <span class="dt">phylo_pheno_100000 =</span> <span class="kw">condinformation</span>(</span>
<span id="cb48-41"><a href="exploration-diagnostic.html#cb48-41"></a>                          <span class="kw">discretize</span>(mean_phenotype_evolutionary_distinctiveness),</span>
<span id="cb48-42"><a href="exploration-diagnostic.html#cb48-42"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(phen_diversity, <span class="dv">10000</span>)),</span>
<span id="cb48-43"><a href="exploration-diagnostic.html#cb48-43"></a>                          <span class="kw">discretize</span>(<span class="kw">lag</span>(mean_phenotype_evolutionary_distinctiveness, <span class="dv">10000</span>)))</span>
<span id="cb48-44"><a href="exploration-diagnostic.html#cb48-44"></a>)</span>
<span id="cb48-45"><a href="exploration-diagnostic.html#cb48-45"></a></span>
<span id="cb48-46"><a href="exploration-diagnostic.html#cb48-46"></a><span class="co"># Turn Transfer Entropy columns into rows</span></span>
<span id="cb48-47"><a href="exploration-diagnostic.html#cb48-47"></a>res &lt;-<span class="st"> </span>res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">contains</span>(<span class="st">&quot;phylo&quot;</span>))</span>
<span id="cb48-48"><a href="exploration-diagnostic.html#cb48-48"></a><span class="co"># Pull lag into a column</span></span>
<span id="cb48-49"><a href="exploration-diagnostic.html#cb48-49"></a>res<span class="op">$</span>offset &lt;-<span class="st"> </span><span class="kw">str_extract</span>(res<span class="op">$</span>name, <span class="st">&quot;[:digit:]*$&quot;</span>)</span>
<span id="cb48-50"><a href="exploration-diagnostic.html#cb48-50"></a><span class="co"># Make column indicating direction of transfer entropy</span></span>
<span id="cb48-51"><a href="exploration-diagnostic.html#cb48-51"></a>res<span class="op">$</span>Type &lt;-<span class="st"> </span><span class="kw">case_when</span>(<span class="kw">str_detect</span>(res<span class="op">$</span>name, <span class="st">&quot;phylo_pheno&quot;</span>) <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;</span><span class="ch">\n</span><span class="st">Phylogenetic</span><span class="ch">\n\t</span><span class="st">-&gt;</span><span class="ch">\n</span><span class="st">Phenotypic</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb48-52"><a href="exploration-diagnostic.html#cb48-52"></a></span>
<span id="cb48-53"><a href="exploration-diagnostic.html#cb48-53"></a><span class="kw">ggplot</span>(</span>
<span id="cb48-54"><a href="exploration-diagnostic.html#cb48-54"></a>  res, </span>
<span id="cb48-55"><a href="exploration-diagnostic.html#cb48-55"></a>  <span class="kw">aes</span>(</span>
<span id="cb48-56"><a href="exploration-diagnostic.html#cb48-56"></a>    <span class="dt">x=</span><span class="kw">as.factor</span>(offset), </span>
<span id="cb48-57"><a href="exploration-diagnostic.html#cb48-57"></a>    <span class="dt">y=</span>value, </span>
<span id="cb48-58"><a href="exploration-diagnostic.html#cb48-58"></a>    <span class="dt">color=</span>Type</span>
<span id="cb48-59"><a href="exploration-diagnostic.html#cb48-59"></a>    )</span>
<span id="cb48-60"><a href="exploration-diagnostic.html#cb48-60"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-61"><a href="exploration-diagnostic.html#cb48-61"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-62"><a href="exploration-diagnostic.html#cb48-62"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>selection_name) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-63"><a href="exploration-diagnostic.html#cb48-63"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="st">&quot;Lag&quot;</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;1000&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;100000&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-64"><a href="exploration-diagnostic.html#cb48-64"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Transfer Entropy&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-65"><a href="exploration-diagnostic.html#cb48-65"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb48-66"><a href="exploration-diagnostic.html#cb48-66"></a>        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-67"><a href="exploration-diagnostic.html#cb48-67"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="phylodiversity-in-EC-supplement_files/figure-html/information_theory_pheno_phylo_med_shannon-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="other-fitness-landscapes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/emilydolson/phylodiversity-metrics-in-EC-GPTP-2021/tree/master/analysis/Exploration_diagnostic_analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["phylodiversity-in-EC-supplement.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
